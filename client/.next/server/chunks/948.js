"use strict";exports.id=948,exports.ids=[948],exports.modules={2979:(e,r,a)=>{a.d(r,{OE:()=>h,U2:()=>f,eR:()=>k});var t=a(326),s=a(7577),l=a(1135),d=a(1009),i=a(7202),n=a(9256),o=a(1019),c=a(5696);let m={default:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 outlined:bg-transparent outlined:border-gray-300 outlined:text-gray-700 dark:outlined:border-gray-600 dark:outlined:text-gray-300",primary:"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-400 outlined:bg-transparent outlined:border-primary-500 outlined:text-primary-600 dark:outlined:text-primary-400",success:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 outlined:bg-transparent outlined:border-green-500 outlined:text-green-600 dark:outlined:text-green-400",warning:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 outlined:bg-transparent outlined:border-amber-500 outlined:text-amber-600 dark:outlined:text-amber-400",danger:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 outlined:bg-transparent outlined:border-red-500 outlined:text-red-600 dark:outlined:text-red-400",info:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 outlined:bg-transparent outlined:border-blue-500 outlined:text-blue-600 dark:outlined:text-blue-400"},x={sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-0.5 text-xs",lg:"px-2.5 py-1 text-sm"},g=(0,s.forwardRef)(({className:e,children:r,variant:a="default",size:s="md",dot:i=!1,outlined:n=!1,...o},c)=>(0,t.jsxs)("span",{ref:c,className:(0,d.m6)((0,l.W)("inline-flex items-center font-medium rounded-full",m[a],x[s],n&&"border",e)),...o,children:[i&&t.jsx("span",{className:(0,l.W)("mr-1.5 h-1.5 w-1.5 rounded-full",{default:"bg-gray-500",primary:"bg-primary-500",success:"bg-green-500",warning:"bg-amber-500",danger:"bg-red-500",info:"bg-blue-500"}[a]),"aria-hidden":"true"}),r]}));g.displayName="Badge";let u={backlog:"default",todo:"primary",in_progress:"warning",review:"info",done:"success"},p={backlog:"Backlog",todo:"To Do",in_progress:"In Progress",review:"Review",done:"Done"},h=(0,s.forwardRef)(({status:e,children:r,...a},s)=>t.jsx(g,{ref:s,variant:u[e],dot:!0,...a,children:r||p[e]}));h.displayName="StatusBadge";let b={low:"default",medium:"primary",high:"warning",urgent:"danger"},y={low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},j={urgent:{icon:i.Z,colorClass:"text-red-600 dark:text-red-400",pattern:"Solid background"},high:{icon:n.Z,colorClass:"text-orange-600 dark:text-orange-400",pattern:"Diagonal lines"},medium:{icon:o.Z,colorClass:"text-blue-600 dark:text-blue-400",pattern:"Dotted"},low:{icon:c.Z,colorClass:"text-gray-600 dark:text-gray-400",pattern:"Striped"}},f=(0,s.forwardRef)(({priority:e,children:r,showIcon:a=!0,showLabel:i=!0,className:n,...o},c)=>{let[g,u]=(0,s.useState)(!1),p=j[e],h=p.icon,f=r||y[e];return(0,t.jsxs)("span",{ref:c,className:(0,d.m6)((0,l.W)("inline-flex items-center font-medium rounded-full",m[b[e]],x.sm,"relative",n)),role:"img","aria-label":`Priority: ${y[e]}`,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onFocus:()=>u(!0),onBlur:()=>u(!1),...o,children:[a&&t.jsx(h,{className:(0,d.m6)((0,l.W)("w-3 h-3 mr-1",p.colorClass)),"aria-hidden":"true"}),i&&t.jsx("span",{children:f}),g&&(0,t.jsxs)("span",{role:"tooltip",className:(0,d.m6)((0,l.W)("absolute bottom-full left-1/2 -translate-x-1/2 mb-2","px-2 py-1 text-xs whitespace-nowrap","bg-gray-900 dark:bg-gray-700 text-white","rounded-md shadow-lg","z-50","animate-fade-in")),children:[y[e]," Priority",t.jsx("span",{className:(0,d.m6)((0,l.W)("absolute top-full left-1/2 -translate-x-1/2","border-4 border-transparent","border-t-gray-900 dark:border-t-gray-700")),"aria-hidden":"true"})]})]})});f.displayName="PriorityBadge";let k=(0,s.forwardRef)(({tag:e,size:r="md",className:a,...s},i)=>{let n=(e=>{let r=e.replace("#",""),a=parseInt(r.substr(0,2),16);return(.299*a+.587*parseInt(r.substr(2,2),16)+.114*parseInt(r.substr(4,2),16))/255>.5?"#1f2937":"#f9fafb"})(e.color);return(0,t.jsxs)("span",{ref:i,className:(0,d.m6)((0,l.W)("inline-flex items-center font-medium rounded-full",{sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-0.5 text-xs",lg:"px-2.5 py-1 text-sm"}[r],a)),style:{backgroundColor:e.color,color:n},...s,children:[t.jsx("span",{className:"mr-1.5 h-1.5 w-1.5 rounded-full",style:{backgroundColor:n},"aria-hidden":"true"}),e.name]})});k.displayName="TagBadge"},9957:(e,r,a)=>{a.d(r,{Pm:()=>s});var t=a(326);function s({percent:e,color:r,className:a=""}){let s=Math.min(100,Math.max(0,e));return t.jsx("div",{className:`h-1 w-full bg-gray-200 rounded-full overflow-hidden ${a}`,role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,children:t.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${r||(s>=100?"bg-green-500":s>=50?"bg-yellow-500":"bg-blue-500")}`,style:{width:`${s}%`}})})}a(7577)},371:(e,r,a)=>{a.d(r,{t:()=>W});var t=a(326),s=a(7577),l=a(1135),d=a(1009),i=a(6625),n=a(210),o=a(2200),c=a(6660),m=a(9635),x=a(4061),g=a(4019),u=a(3855),p=a(765),h=a(321),b=a(7358),y=a(5342),j=a(5738),f=a(2979),k=a(9957);function N({field:e,value:r,onChange:a,disabled:s=!1,error:l}){let d=`custom-field-${e.id}`,i=`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white ${l?"border-red-500":"border-gray-300 dark:border-gray-600"} ${s?"opacity-50 cursor-not-allowed":""}`,n=r=>{a(e.id,r)};switch(e.field_type){case"text":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",id:d,value:r||"",onChange:e=>n(e.target.value||null),disabled:s,className:i,placeholder:`Enter ${e.name.toLowerCase()}`,required:e.required}),l&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:l})]});case"number":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"number",id:d,value:r??"",onChange:e=>{let r=e.target.value;n(r?parseFloat(r):null)},disabled:s,className:i,placeholder:`Enter ${e.name.toLowerCase()}`,required:e.required,step:"any"}),l&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:l})]});case"date":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"date",id:d,value:r||"",onChange:e=>n(e.target.value||null),disabled:s,className:i,required:e.required}),l&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:l})]});case"select":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("select",{id:d,value:r||"",onChange:e=>n(e.target.value||null),disabled:s,className:i,required:e.required,children:[(0,t.jsxs)("option",{value:"",children:["Select ",e.name.toLowerCase(),"..."]}),e.options?.map((e,r)=>t.jsx("option",{value:e,children:e},r))]}),l&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:l})]});case"multiselect":return t.jsx(v,{field:e,value:r,onChange:n,disabled:s,error:l,inputId:d});case"checkbox":return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:d,checked:!!r,onChange:e=>n(e.target.checked),disabled:s,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",required:e.required}),(0,t.jsxs)("label",{htmlFor:d,className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l&&t.jsx("p",{className:"text-sm text-red-500",children:l})]});case"url":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"url",id:d,value:r||"",onChange:e=>n(e.target.value||null),disabled:s,className:i,placeholder:"https://example.com",required:e.required}),l&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:l})]});default:return(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Unknown field type: ",e.field_type]})}}function v({field:e,value:r,onChange:a,disabled:l,error:d,inputId:i}){let[n,o]=(0,s.useState)(!1),c=(0,s.useRef)(null),m=r||[],x=e=>{if(m.includes(e)){let r=m.filter(r=>r!==e);a(r.length>0?r:null)}else a([...m,e])},g=e=>{let r=m.filter(r=>r!==e);a(r.length>0?r:null)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:i,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.name,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("div",{ref:c,className:"relative",children:[(0,t.jsxs)("div",{className:`w-full min-h-[42px] px-3 py-2 border rounded-md shadow-sm cursor-pointer flex flex-wrap gap-1 items-center dark:bg-gray-700 ${d?"border-red-500":"border-gray-300 dark:border-gray-600"} ${l?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!l&&o(!n),children:[0===m.length?(0,t.jsxs)("span",{className:"text-gray-400 dark:text-gray-500",children:["Select ",e.name.toLowerCase(),"..."]}):m.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-100 text-sm rounded-md",children:[e,t.jsx("button",{type:"button",onClick:r=>{r.stopPropagation(),g(e)},className:"text-blue-600 dark:text-blue-300 hover:text-blue-800 dark:hover:text-blue-100 focus:outline-none","aria-label":`Remove ${e}`,children:t.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e)),t.jsx("svg",{className:`w-4 h-4 ml-auto text-gray-400 transition-transform ${n?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&!l&&(0,t.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:[e.options?.map(e=>t.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:m.includes(e),onChange:()=>x(e),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})]},e)),(!e.options||0===e.options.length)&&t.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No options available"})]})]}),d&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:d})]})}var w=a(6024),_=a(2211),C=a(2712),S=a(7515);function W({task:e,project:r,projectId:a,parentTaskId:v,onSubmit:W,onCancel:Z,isLoading:M=!1}){let F=!!e,D=e?.project_id||a||r?.id,{projectPeople:L,people:P}=(0,w.u$)(),{availableTags:E}=(0,_.e0)(),{tasks:T}=(0,C.Xi)(),{availableFields:$,fetchCustomFields:B,fetchTaskCustomFields:O,setTaskCustomField:q,getTaskFieldValue:z}=(0,S.mZ)(),[A,I]=(0,s.useState)(new Map),R=(0,s.useMemo)(()=>D?T.filter(r=>r.project_id===D&&r.id!==e?.id):[],[T,D,e?.id]),U=(0,s.useMemo)(()=>D?P.filter(e=>!e.project_id||e.project_id===D):P,[P,D]),V=(0,s.useMemo)(()=>E,[E]),[J,X]=(0,s.useState)({title:e?.title||"",description:e?.description||"",status:e?.status||"todo",priority:e?.priority||"medium",due_date:e?.due_date?e.due_date.split("T")[0]:"",start_date:e?.start_date?e.start_date.split("T")[0]:"",assignee_id:e?.assignee_id||null,parent_task_id:e?.parent_task_id||v||null,progress_percent:e?.progress_percent||0,estimated_duration_minutes:e?.estimated_duration_minutes||0,actual_duration_minutes:e?.actual_duration_minutes||0}),[K,H]=(0,s.useState)([]),[Q,Y]=(0,s.useState)([]),[G,ee]=(0,s.useState)(!1),[er,ea]=(0,s.useState)(!1),[et,es]=(0,s.useState)({}),el=()=>{let e={};return J.title.trim()?J.title.length>200&&(e.title="Task title must be less than 200 characters"):e.title="Task title is required",J.description.length>2e3&&(e.description="Description must be less than 2000 characters"),J.start_date&&J.due_date&&new Date(J.start_date)>new Date(J.due_date)&&(e.start_date="Start date cannot be after due date",e.due_date="Due date cannot be before start date"),es(e),0===Object.keys(e).length},ed=async r=>{if(r.preventDefault(),el())try{let r={title:J.title.trim(),description:J.description.trim(),status:J.status,priority:J.priority,due_date:J.due_date||null,start_date:J.start_date||null,assignee_id:J.assignee_id||void 0,parent_task_id:J.parent_task_id||null,progress_percent:J.progress_percent,estimated_duration_minutes:J.estimated_duration_minutes||void 0,actual_duration_minutes:J.actual_duration_minutes||void 0,...F?{}:{project_id:D,tag_ids:Q.map(e=>e.id),co_assignee_ids:K.map(e=>e.id)}};if(await W(r),e?.id)for(let[r,a]of A)await q(e.id,r,a)}catch{}},ei=(e,r)=>{I(a=>{let t=new Map(a);return t.set(e,r),t})},en=e=>{let{name:r,value:a,type:t}=e.target;"assignee_id"===r?X(e=>({...e,[r]:a?Number(a):null})):"parent_task_id"===r?X(e=>({...e,[r]:a?Number(a):null})):"number"===t?X(e=>({...e,[r]:Number(a)})):X(e=>({...e,[r]:a})),et[r]&&es(e=>({...e,[r]:void 0}))},eo=e=>{let r=U.find(r=>r.id===e);r&&!K.find(r=>r.id===e)&&J.assignee_id!==e&&H(e=>[...e,r]),ee(!1)},ec=e=>{H(r=>r.filter(r=>r.id!==e))},em=e=>{let r=V.find(r=>r.id===e);r&&!Q.find(r=>r.id===e)&&Y(e=>[...e,r]),ea(!1)},ex=e=>{Y(r=>r.filter(r=>r.id!==e))},eg=(0,s.useMemo)(()=>U.filter(e=>e.id!==J.assignee_id&&!K.find(r=>r.id===e.id)),[U,J.assignee_id,K]),eu=(0,s.useMemo)(()=>V.filter(e=>!Q.find(r=>r.id===e.id)),[V,Q]),ep=e=>{if(0===e)return"0m";let r=Math.floor(e/60),a=e%60;return 0===r?`${a}m`:0===a?`${r}h`:`${r}h ${a}m`};return(0,t.jsxs)("form",{onSubmit:ed,className:"space-y-4",children:[r&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 pb-2",children:[t.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:r.color}}),t.jsx("span",{children:r.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Task Title ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",id:"title",name:"title",value:J.title,onChange:en,placeholder:"Enter task title",className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",et.title?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:M,autoFocus:!0}),et.title&&t.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:et.title})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),t.jsx("textarea",{id:"description",name:"description",value:J.description,onChange:en,placeholder:"Enter task description (optional)",rows:3,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm resize-none","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",et.description?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:M}),et.description&&t.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:et.description}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[J.description.length,"/2000 characters"]})]}),R.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"parent_task_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(i.Z,{className:"w-4 h-4 inline-block mr-1"}),"Parent Task"]}),(0,t.jsxs)("select",{id:"parent_task_id",name:"parent_task_id",value:J.parent_task_id||"",onChange:en,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:M,children:[t.jsx("option",{value:"",children:"No parent task (top-level)"}),R.map(e=>t.jsx("option",{value:e.id,children:e.title},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(n.Z,{className:"w-4 h-4 inline-block mr-1"}),"Status"]}),t.jsx("select",{id:"status",name:"status",value:J.status,onChange:en,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:M,children:Object.entries(y.RS).map(([e,r])=>t.jsx("option",{value:e,children:r.label},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(o.Z,{className:"w-4 h-4 inline-block mr-1"}),"Priority"]}),t.jsx("select",{id:"priority",name:"priority",value:J.priority,onChange:en,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:M,children:Object.entries(y.Fr).map(([e,r])=>t.jsx("option",{value:e,children:r.label},e))})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800/50 rounded-md space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t.jsx(c.Z,{className:"w-4 h-4 inline-block mr-1"}),"Progress & Duration"]}),J.progress_percent>0&&(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:[J.progress_percent,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"range",id:"progress_percent",name:"progress_percent",min:"0",max:"100",value:J.progress_percent,onChange:en,className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:M}),(0,t.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400 w-12 text-right",children:[J.progress_percent,"%"]})]}),t.jsx("div",{className:"mt-2",children:t.jsx(k.Pm,{percent:J.progress_percent})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"estimated_duration_minutes",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Estimated (minutes)"}),t.jsx("input",{type:"number",id:"estimated_duration_minutes",name:"estimated_duration_minutes",min:"0",step:"15",value:J.estimated_duration_minutes,onChange:en,placeholder:"0",className:(0,d.m6)((0,l.W)("w-full px-3 py-1.5 rounded-md border shadow-sm text-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:M}),J.estimated_duration_minutes>0&&(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["= ",ep(J.estimated_duration_minutes)]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"actual_duration_minutes",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Actual (minutes)"}),t.jsx("input",{type:"number",id:"actual_duration_minutes",name:"actual_duration_minutes",min:"0",step:"15",value:J.actual_duration_minutes,onChange:en,placeholder:"0",className:(0,d.m6)((0,l.W)("w-full px-3 py-1.5 rounded-md border shadow-sm text-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:M}),J.actual_duration_minutes>0&&(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["= ",ep(J.actual_duration_minutes)]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"assignee_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(m.Z,{className:"w-4 h-4 inline-block mr-1"}),"Primary Assignee"]}),(0,t.jsxs)("select",{id:"assignee_id",name:"assignee_id",value:J.assignee_id||"",onChange:en,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:M,children:[t.jsx("option",{value:"",children:"Unassigned"}),U.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name,e.designation&&` (${e.designation})`]},e.id))]}),J.assignee_id&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:t.jsx("span",{className:"text-primary-600 dark:text-primary-400 text-xs font-medium",children:U.find(e=>e.id===J.assignee_id)?.name.charAt(0).toUpperCase()})}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:U.find(e=>e.id===J.assignee_id)?.name})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(x.Z,{className:"w-4 h-4 inline-block mr-1"}),"Co-Assignees"]}),K.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:K.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded-md",children:[t.jsx("div",{className:"w-5 h-5 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:t.jsx("span",{className:"text-primary-600 dark:text-primary-400 text-xs font-medium",children:e.name.charAt(0).toUpperCase()})}),t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name}),t.jsx("button",{type:"button",onClick:()=>ec(e.id),className:"ml-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",disabled:M,children:t.jsx(g.Z,{className:"w-3 h-3"})})]},e.id))}),eg.length>0&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>ee(!G),className:(0,d.m6)((0,l.W)("flex items-center gap-1 px-3 py-1.5 text-sm rounded-md border border-dashed","text-gray-500 dark:text-gray-400","hover:border-gray-400 dark:hover:border-gray-500","hover:text-gray-700 dark:hover:text-gray-300","border-gray-300 dark:border-gray-600")),disabled:M,children:[t.jsx(u.Z,{className:"w-4 h-4"}),"Add co-assignee"]}),G&&(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>ee(!1)}),t.jsx("div",{className:"absolute left-0 top-full mt-1 w-64 max-h-48 overflow-y-auto bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:eg.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>eo(e.id),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:t.jsx("span",{className:"text-primary-600 dark:text-primary-400 text-xs font-medium",children:e.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:e.name}),e.designation&&t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.designation})]})]},e.id))})]})]}),0===eg.length&&0===K.length&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No additional people available"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(p.Z,{className:"w-4 h-4 inline-block mr-1"}),"Tags"]}),Q.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Q.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[t.jsx(f.eR,{tag:e,size:"sm"}),t.jsx("button",{type:"button",onClick:()=>ex(e.id),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",disabled:M,children:t.jsx(g.Z,{className:"w-3 h-3"})})]},e.id))}),eu.length>0&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>ea(!er),className:(0,d.m6)((0,l.W)("flex items-center gap-1 px-3 py-1.5 text-sm rounded-md border border-dashed","text-gray-500 dark:text-gray-400","hover:border-gray-400 dark:hover:border-gray-500","hover:text-gray-700 dark:hover:text-gray-300","border-gray-300 dark:border-gray-600")),disabled:M,children:[t.jsx(u.Z,{className:"w-4 h-4"}),"Add tag"]}),er&&(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>ea(!1)}),t.jsx("div",{className:"absolute left-0 top-full mt-1 w-48 max-h-48 overflow-y-auto bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:eu.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>em(e.id),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),t.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:e.name})]},e.id))})]})]}),0===eu.length&&0===Q.length&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No tags available"})]}),$.length>0&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[t.jsx(h.Z,{className:"w-4 h-4 inline-block mr-1"}),"Custom Fields"]}),t.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-800/50 rounded-md space-y-3",children:$.map(e=>t.jsx(N,{field:e,value:A.get(e.id),onChange:r=>ei(e.id,r),disabled:M},e.id))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(b.Z,{className:"w-4 h-4 inline-block mr-1"}),"Start Date"]}),t.jsx("input",{type:"date",id:"start_date",name:"start_date",value:J.start_date,onChange:en,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",et.start_date?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:M}),et.start_date&&t.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:et.start_date})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"due_date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(b.Z,{className:"w-4 h-4 inline-block mr-1"}),"Due Date"]}),t.jsx("input",{type:"date",id:"due_date",name:"due_date",value:J.due_date,onChange:en,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",et.due_date?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:M}),et.due_date&&t.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:et.due_date})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx(j.z,{type:"button",variant:"secondary",onClick:Z,disabled:M,children:"Cancel"}),t.jsx(j.z,{type:"submit",variant:"primary",isLoading:M,leftIcon:M?void 0:t.jsx(n.Z,{className:"w-4 h-4"}),children:F?"Update Task":"Create Task"})]})]})}},948:(e,r,a)=>{a.d(r,{A:()=>ee});var t=a(326),s=a(7577),l=a(1135),d=a(1009),i=a(748),n=a(850),o=a(2607),c=a(9216),m=a(8998),x=a(3510),g=a(8932),u=a(8393),p=a(6633),h=a(5290),b=a(3855),y=a(2200),j=a(7358),f=a(2712),k=a(7176),N=a(1623);let v={urgent:{label:"Urgent",color:"text-red-500"},high:{label:"High",color:"text-orange-500"},medium:{label:"Medium",color:"text-blue-500"},low:{label:"Low",color:"text-gray-500"}};function w({className:e}){let[r,a]=(0,s.useState)(""),[i,n]=(0,s.useState)(null),[o,c]=(0,s.useState)("medium"),[m,w]=(0,s.useState)(""),[_,C]=(0,s.useState)(!1),[S,W]=(0,s.useState)(!1),[Z,M]=(0,s.useState)(!1),[F,D]=(0,s.useState)(!1),L=(0,s.useRef)(null),P=(0,s.useRef)(null),E=(0,s.useRef)(null),{createTask:T}=(0,f.Xi)(),{projects:$,currentProject:B}=(0,x.Z0)(),{showToast:O}=(0,k.pm)(),{registerShortcut:q,unregisterShortcut:z}=(0,N.XU)(),A=i||B?.id,I=$.find(e=>e.id===A),R=(0,s.useCallback)(async e=>{if(e?.preventDefault(),!r.trim()){O("Please enter a task title","warning");return}if(!A){O("Please select a project first","warning");return}W(!0);try{await T({title:r.trim(),project_id:A,status:"todo",priority:o,due_date:m||void 0}),O("Task created successfully","success"),a(""),w(""),c("medium"),C(!1)}catch(e){O("Failed to create task","error"),console.error("Failed to create task:",e)}finally{W(!1)}},[r,A,o,m,T,O]);return t.jsx("div",{className:(0,d.m6)((0,l.W)("relative",e)),children:(0,t.jsxs)("form",{onSubmit:R,className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"relative flex-1",children:t.jsx("input",{ref:L,type:"text",value:r,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),R()),"Escape"===e.key&&(L.current?.blur(),M(!1),D(!1))},placeholder:"Quick add task... (Press Enter)",disabled:S,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 text-sm rounded-lg border","bg-gray-50 dark:bg-gray-700","border-gray-200 dark:border-gray-600","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-blue-500","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Quick add task"})}),(0,t.jsxs)("div",{className:"relative",ref:P,children:[(0,t.jsxs)("button",{type:"button",onClick:()=>M(!Z),disabled:S,className:(0,d.m6)((0,l.W)("flex items-center gap-1 px-2 py-2 text-sm rounded-lg border","bg-gray-50 dark:bg-gray-700","border-gray-200 dark:border-gray-600","text-gray-700 dark:text-gray-300","hover:bg-gray-100 dark:hover:bg-gray-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Select project","aria-expanded":Z,"aria-haspopup":"listbox",children:[I?(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-sm",style:{backgroundColor:I.color},"aria-hidden":"true"}),t.jsx("span",{className:"hidden sm:inline max-w-[100px] truncate",children:I.name})]}):t.jsx(g.Z,{className:"w-4 h-4"}),t.jsx(u.Z,{className:(0,d.m6)((0,l.W)("w-3 h-3 transition-transform",Z&&"rotate-180"))})]}),Z&&t.jsx("div",{role:"listbox",className:(0,d.m6)((0,l.W)("absolute top-full right-0 mt-1 z-50","min-w-[200px] max-h-[300px] overflow-y-auto","bg-white dark:bg-gray-800","border border-gray-200 dark:border-gray-700","rounded-lg shadow-lg","py-1")),children:0===$.length?t.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No projects available"}):$.map(e=>(0,t.jsxs)("button",{type:"button",role:"option","aria-selected":A===e.id,onClick:()=>{n(e.id),M(!1)},className:(0,d.m6)((0,l.W)("w-full flex items-center gap-2 px-3 py-2 text-sm text-left","hover:bg-gray-100 dark:hover:bg-gray-700",A===e.id&&"bg-blue-50 dark:bg-blue-900/30")),children:[t.jsx("div",{className:"w-2.5 h-2.5 rounded-sm flex-shrink-0",style:{backgroundColor:e.color},"aria-hidden":"true"}),t.jsx("span",{className:"truncate",children:e.name})]},e.id))})]}),t.jsx("button",{type:"button",onClick:()=>C(!_),disabled:S,className:(0,d.m6)((0,l.W)("p-2 text-sm rounded-lg border","bg-gray-50 dark:bg-gray-700","border-gray-200 dark:border-gray-600","text-gray-500 dark:text-gray-400","hover:bg-gray-100 dark:hover:bg-gray-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":_?"Collapse options":"Expand options","aria-expanded":_,children:_?t.jsx(p.Z,{className:"w-4 h-4"}):t.jsx(u.Z,{className:"w-4 h-4"})}),t.jsx("button",{type:"submit",disabled:S||!r.trim(),className:(0,d.m6)((0,l.W)("flex items-center justify-center p-2 text-sm rounded-lg","bg-blue-500 hover:bg-blue-600","text-white","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Add task",children:S?t.jsx(h.Z,{className:"w-4 h-4 animate-spin"}):t.jsx(b.Z,{className:"w-4 h-4"})})]}),_&&(0,t.jsxs)("div",{className:"flex items-center gap-2 pl-1",children:[(0,t.jsxs)("div",{className:"relative",ref:E,children:[(0,t.jsxs)("button",{type:"button",onClick:()=>D(!F),disabled:S,className:(0,d.m6)((0,l.W)("flex items-center gap-1.5 px-2 py-1.5 text-xs rounded-md","bg-gray-100 dark:bg-gray-700","text-gray-600 dark:text-gray-300","hover:bg-gray-200 dark:hover:bg-gray-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Select priority","aria-expanded":F,"aria-haspopup":"listbox",children:[t.jsx(y.Z,{className:(0,d.m6)("w-3.5 h-3.5",v[o].color)}),t.jsx("span",{children:v[o].label}),t.jsx(u.Z,{className:(0,d.m6)((0,l.W)("w-3 h-3 transition-transform",F&&"rotate-180"))})]}),F&&t.jsx("div",{role:"listbox",className:(0,d.m6)((0,l.W)("absolute top-full left-0 mt-1 z-50","min-w-[120px]","bg-white dark:bg-gray-800","border border-gray-200 dark:border-gray-700","rounded-lg shadow-lg","py-1")),children:Object.keys(v).map(e=>(0,t.jsxs)("button",{type:"button",role:"option","aria-selected":o===e,onClick:()=>{c(e),D(!1)},className:(0,d.m6)((0,l.W)("w-full flex items-center gap-2 px-3 py-1.5 text-xs text-left","hover:bg-gray-100 dark:hover:bg-gray-700",o===e&&"bg-blue-50 dark:bg-blue-900/30")),children:[t.jsx(y.Z,{className:(0,d.m6)("w-3.5 h-3.5",v[e].color)}),t.jsx("span",{children:v[e].label})]},e))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[t.jsx(j.Z,{className:"w-3.5 h-3.5 text-gray-400"}),t.jsx("input",{type:"date",value:m,onChange:e=>w(e.target.value),disabled:S,className:(0,d.m6)((0,l.W)("px-2 py-1.5 text-xs rounded-md","bg-gray-100 dark:bg-gray-700","text-gray-600 dark:text-gray-300","border-0","focus:outline-none focus:ring-1 focus:ring-blue-500","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200","[color-scheme:light] dark:[color-scheme:dark]")),"aria-label":"Due date"})]})]})]})})}let _=()=>t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),C=()=>t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})});function S({taskTitle:e,maxItems:r=4,className:a=""}){let{projects:l}=(0,x.Z0)(),{selectedProject:d,selectProject:i}=(0,x.C1)(),{setCurrentView:n}=(0,m.qD)(),o=(0,s.useMemo)(()=>{let r=[];if(r.push({id:"root",label:"Projects",isCurrent:!d&&!e,onClick:()=>{n("dashboard")}}),d){let a=l.find(e=>String(e.id)===d);if(a){let t=[...(0,x.LZ)(l,a.id),a];t.forEach((a,s)=>{let l=s===t.length-1&&!e;r.push({id:String(a.id),label:a.name,color:a.color,isCurrent:l,onClick:()=>{i(String(a.id)),n("kanban")}})})}}return e&&r.push({id:"task",label:e,isCurrent:!0}),r},[l,d,e,n,i]),c=(0,s.useMemo)(()=>o.length<=r?o:[o[0],"ellipsis",...o.slice(-(r-2))],[o,r]);return o.length<=1&&!e?null:t.jsx("nav",{className:`flex items-center gap-1 text-sm ${a}`,"aria-label":"Breadcrumb",children:t.jsx("ol",{className:"flex items-center gap-1 flex-wrap",children:c.map((e,r)=>"ellipsis"===e?(0,t.jsxs)("li",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-gray-400 px-1",children:"â€¦"}),t.jsx(_,{})]},"ellipsis"):(0,t.jsxs)("li",{className:"flex items-center gap-1",children:[r>0&&t.jsx(_,{}),e.isCurrent?t.jsx("span",{className:"font-semibold text-gray-900 truncate max-w-[200px]",title:e.label,style:e.color?{color:e.color}:void 0,children:e.label}):(0,t.jsxs)("button",{onClick:e.onClick,className:"text-gray-500 hover:text-gray-700 hover:underline transition-colors truncate max-w-[150px] flex items-center gap-1",title:e.label,children:["root"===e.id&&t.jsx(C,{}),e.color&&t.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),t.jsx("span",{className:"truncate",children:e.label})]})]},e.id))})})}function W(){let{sidebarOpen:e,toggleSidebar:r,darkMode:a,toggleDarkMode:s,currentView:g}=(0,m.qD)(),{currentProject:u}=(0,x.Z0)();return(0,t.jsxs)("header",{className:"sticky top-0 z-30 flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:r,className:(0,d.m6)((0,l.W)("p-2 rounded-md text-gray-500 hover:text-gray-700","dark:text-gray-400 dark:hover:text-gray-200","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-200","lg:hidden")),"aria-label":e?"Close sidebar":"Open sidebar",children:t.jsx(i.Z,{className:"w-5 h-5"})}),t.jsx("div",{className:"hidden md:block",children:t.jsx(S,{})}),(0,t.jsxs)("div",{className:"flex flex-col md:hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[u&&t.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:u.color},"aria-hidden":"true"}),t.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:u?.name||"Task Tracking"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:{kanban:"Kanban Board",list:"List View",calendar:"Calendar",timeline:"Timeline",dashboard:"Dashboard"}[g]||"Tasks"})]})]}),t.jsx("div",{className:"hidden md:flex flex-1 max-w-xl mx-4",children:t.jsx(w,{className:"w-full"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:s,className:(0,d.m6)((0,l.W)("p-2 rounded-md text-gray-500 hover:text-gray-700","dark:text-gray-400 dark:hover:text-gray-200","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-200")),"aria-label":a?"Switch to light mode":"Switch to dark mode",children:a?t.jsx(n.Z,{className:"w-5 h-5"}):t.jsx(o.Z,{className:"w-5 h-5"})}),t.jsx("div",{className:"relative",children:t.jsx("button",{className:(0,d.m6)((0,l.W)("p-2 rounded-md text-gray-500 hover:text-gray-700","dark:text-gray-400 dark:hover:text-gray-200","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-200")),"aria-label":"More options",children:t.jsx(c.Z,{className:"w-5 h-5"})})})]})]})}var Z=a(5047),M=a(3499),F=a(9389),D=a(1016),L=a(4319),P=a(4019),E=a(4061),T=a(7492),$=a(9183),B=a(6024);let O=[{id:"kanban",label:"Kanban",icon:t.jsx(M.Z,{className:"w-4 h-4"})},{id:"list",label:"List",icon:t.jsx(F.Z,{className:"w-4 h-4"})},{id:"calendar",label:"Calendar",icon:t.jsx(j.Z,{className:"w-4 h-4"})},{id:"timeline",label:"Timeline",icon:t.jsx(D.Z,{className:"w-4 h-4"})},{id:"dashboard",label:"Dashboard",icon:t.jsx(L.Z,{className:"w-4 h-4"})}];function q({onAddProject:e}){let r=(0,Z.useParams)();r?.projectId;let a=(0,Z.useRouter)(),i=(0,Z.usePathname)(),{sidebarOpen:n,setSidebarOpen:o,currentView:c,setCurrentView:g,setCurrentProjectId:u}=(0,m.qD)(),{projects:p,currentProject:h,setCurrentProject:b}=(0,x.Z0)(),{people:y}=(0,B.u$)(),j=(0,s.useRef)(null),f=e=>{b(e),u(e.id),a.push(`/projects/${e.id}/${c}`),window.innerWidth<1024&&o(!1)},k=e=>{g(e),h&&a.push(`/projects/${h.id}/${e}`),window.innerWidth<1024&&o(!1)},N=e=>e.owner_id?y.find(r=>r.id===e.owner_id):null,v=i?.startsWith("/people")??!1,w=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-500 flex items-center justify-center",children:t.jsx(M.Z,{className:"w-5 h-5 text-white"})}),t.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"TaskTrack"})]}),t.jsx("button",{onClick:()=>o(!1),className:"p-1.5 rounded-md text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 lg:hidden","aria-label":"Close sidebar",children:t.jsx(P.Z,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h2",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2",children:"Views"}),t.jsx("nav",{className:"space-y-1",children:O.map(e=>(0,t.jsxs)("button",{onClick:()=>k(e.id),className:(0,d.m6)((0,l.W)("w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium","transition-colors duration-200",c!==e.id||v?"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700":"bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-400")),children:[e.icon,e.label]},e.id))})]}),(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h2",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2",children:"Manage"}),t.jsx("nav",{className:"space-y-1",children:(0,t.jsxs)("button",{onClick:()=>{a.push("/people"),window.innerWidth<1024&&o(!1)},className:(0,d.m6)((0,l.W)("w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium","transition-colors duration-200",v?"bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-400":"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700")),children:[t.jsx(E.Z,{className:"w-4 h-4"}),"People"]})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 scrollbar-thin",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h2",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider",children:"Projects"}),e&&t.jsx("button",{onClick:e,className:"p-1 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Add project",children:t.jsx(T.Z,{className:"w-4 h-4"})})]}),0===p.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No projects yet"}),e&&t.jsx("button",{onClick:e,className:"mt-2 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400",children:"Create your first project"})]}):t.jsx("nav",{className:"space-y-1",children:p.map(e=>{let r=N(e),a=r?.name?.charAt(0)?.toUpperCase()||"?";return(0,t.jsxs)("button",{onClick:()=>f(e),className:(0,d.m6)((0,l.W)("w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium","transition-colors duration-200",h?.id===e.id?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100":"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700")),children:[t.jsx("div",{className:"w-3 h-3 rounded-sm flex-shrink-0",style:{backgroundColor:e.color}}),t.jsx("span",{className:"truncate flex-1 text-left",children:e.name}),r&&t.jsx("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-gray-100 dark:bg-gray-600 flex-shrink-0",title:`Owner: ${r.name}`,children:t.jsx("div",{className:"w-4 h-4 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:t.jsx("span",{className:"text-[10px] font-medium text-primary-600 dark:text-primary-400",children:a})})}),h?.id===e.id&&t.jsx($.Z,{className:"w-4 h-4 ml-auto text-gray-400"})]},e.id)})})]}),t.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:t.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:"Task Tracking v1.0.0"})})]});return(0,t.jsxs)(t.Fragment,{children:[t.jsx("aside",{ref:j,className:(0,d.m6)((0,l.W)("hidden lg:flex flex-col w-64 h-screen","bg-white dark:bg-gray-800","border-r border-gray-200 dark:border-gray-700","transition-all duration-300 ease-in-out",!n&&"lg:w-0 lg:overflow-hidden")),children:w}),n&&(0,t.jsxs)("div",{className:"fixed inset-0 z-40 lg:hidden",children:[t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>o(!1)}),t.jsx("aside",{className:(0,d.m6)((0,l.W)("fixed inset-y-0 left-0 z-50","flex flex-col w-72 h-screen","bg-white dark:bg-gray-800","animate-slide-left")),children:w})]})]})}let z=`
  @keyframes slideLeft {
    from {
      transform: translateX(-100%);
    }
    to {
      transform: translateX(0);
    }
  }
  
  .animate-slide-left {
    animation: slideLeft 0.3s ease-out;
  }
`;if("undefined"!=typeof document){let e=document.createElement("style");e.textContent=z,document.head.appendChild(e)}var A=a(4128),I=a(6625),R=a(5529),U=a(5342),V=a(5738);function J({project:e,parentProjectId:r,onSubmit:a,onCancel:i,isLoading:n=!1}){let o=!!e,{projects:c}=(0,x.Z0)(),{people:m}=(0,B.u$)(),g=(0,s.useMemo)(()=>c.filter(r=>r.id!==e?.id),[c,e?.id]),[u,p]=(0,s.useState)({name:e?.name||"",description:e?.description||"",color:e?.color||U.MW[0],parent_project_id:e?.parent_project_id||r||null,owner_id:e?.owner_id||null}),[h,b]=(0,s.useState)({}),y=()=>{let e={};return u.name.trim()?u.name.length>100&&(e.name="Project name must be less than 100 characters"):e.name="Project name is required",u.description.length>500&&(e.description="Description must be less than 500 characters"),b(e),0===Object.keys(e).length},j=async r=>{if(r.preventDefault(),y())try{o&&e?await a({name:u.name.trim(),description:u.description.trim(),color:u.color,parent_project_id:u.parent_project_id,owner_id:u.owner_id}):await a({name:u.name.trim(),description:u.description.trim(),color:u.color,parent_project_id:u.parent_project_id||void 0,owner_id:u.owner_id||void 0})}catch{}},f=e=>{let{name:r,value:a}=e.target;"parent_project_id"===r||"owner_id"===r?p(e=>({...e,[r]:a?Number(a):null})):p(e=>({...e,[r]:a})),h[r]&&b(e=>({...e,[r]:void 0}))},k=(0,s.useMemo)(()=>u.parent_project_id?c.find(e=>e.id===u.parent_project_id):null,[c,u.parent_project_id]),N=(0,s.useMemo)(()=>u.owner_id?m.find(e=>e.id===u.owner_id):null,[m,u.owner_id]);return(0,t.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[g.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"parent_project_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(I.Z,{className:"w-4 h-4 inline-block mr-1"}),"Parent Project"]}),(0,t.jsxs)("select",{id:"parent_project_id",name:"parent_project_id",value:u.parent_project_id||"",onChange:f,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:n,children:[t.jsx("option",{value:"",children:"No parent project (top-level)"}),g.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]}),k&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:k.color}}),(0,t.jsxs)("span",{children:["Sub-project of: ",k.name]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"owner_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t.jsx(R.Z,{className:"w-4 h-4 inline-block mr-1"}),"Project Owner"]}),(0,t.jsxs)("select",{id:"owner_id",name:"owner_id",value:u.owner_id||"",onChange:f,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:n,children:[t.jsx("option",{value:"",children:"No owner"}),m.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name,e.company?` (${e.company})`:""]},e.id))]}),N&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:t.jsx("span",{className:"text-xs font-medium text-primary-600 dark:text-primary-400",children:N.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("span",{children:["Owner: ",N.name]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Project Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:f,placeholder:"Enter project name",className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",h.name?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:n,autoFocus:!0}),h.name&&t.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:h.name})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),t.jsx("textarea",{id:"description",name:"description",value:u.description,onChange:f,placeholder:"Enter project description (optional)",rows:3,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm resize-none","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",h.description?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:n}),h.description&&t.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:h.description}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[u.description.length,"/500 characters"]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:U.MW.map(e=>t.jsx("button",{type:"button",onClick:()=>p(r=>({...r,color:e})),className:(0,d.m6)((0,l.W)("w-8 h-8 rounded-full transition-all duration-200","hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2","dark:focus:ring-offset-gray-800",u.color===e&&"ring-2 ring-offset-2 ring-gray-400")),style:{backgroundColor:e},"aria-label":`Select color ${e}`,disabled:n},e))}),(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:["Selected: ",t.jsx("span",{className:"font-mono",children:u.color})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:u.color},children:t.jsx(T.Z,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:u.name||"Project Name"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:u.description||"No description"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[u.parent_project_id&&k&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:[t.jsx(I.Z,{className:"w-3 h-3 inline-block mr-1"}),"Sub-project of ",k.name]}),N&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1",children:[t.jsx(R.Z,{className:"w-3 h-3 inline-block"}),"Owner: ",N.name]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx(V.z,{type:"button",variant:"secondary",onClick:i,disabled:n,children:"Cancel"}),t.jsx(V.z,{type:"submit",variant:"primary",isLoading:n,leftIcon:n?void 0:t.jsx(T.Z,{className:"w-4 h-4"}),children:o?"Update Project":"Create Project"})]})]})}var X=a(371),K=a(1471);function H(e){return e.toLocaleString()}function Q(e){return new Date(e).toLocaleString()}function Y(e){return({projects:"Projects",tasks:"Tasks",people:"People",tags:"Tags",notes:"Notes",task_assignees:"Task Assignees",task_tags:"Task Tags",project_assignees:"Project Assignees",custom_fields:"Custom Fields",custom_field_values:"Custom Field Values",saved_views:"Saved Views"})[e]||e}function G({onClose:e,onImportComplete:r}){let a=(0,k.pm)(),[l,d]=(0,s.useState)(null),[i,n]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[m,x]=(0,s.useState)("select"),[g,u]=(0,s.useState)("merge"),[p,h]=(0,s.useState)(null),[b,y]=(0,s.useState)(null),[j,f]=(0,s.useState)(null),[N,v]=(0,s.useState)(null),[w,_]=(0,s.useState)(null),C=(0,s.useRef)(null),S=async()=>{try{let e=await K.hi.importExport.getExportStatus();d(e)}catch(e){console.error("Failed to load export status:",e)}},W=async()=>{n(!0);try{await K.hi.importExport.exportData();let e=new Date().toISOString();localStorage.setItem("taskflow-last-export",e),c(e),a.success("Export Complete","Your data has been downloaded as a JSON file.")}catch(e){a.error("Export Failed",e instanceof Error?e.message:"Failed to export data")}finally{n(!1)}},Z=async()=>{n(!0);try{await K.hi.importExport.exportSqlite(),a.success("Export Complete","Your database has been downloaded as a .db file.")}catch(e){a.error("Export Failed",e instanceof Error?e.message:"Failed to export database")}finally{n(!1)}},M=(0,s.useCallback)(e=>{let r=e.target.files?.[0];r&&F(r)},[]),F=async e=>{if(_(null),y(null),h(null),!e.name.endsWith(".json")){_("Please select a valid JSON file");return}try{let r=await e.text(),a=JSON.parse(r);if(!a.version||!a.exportedAt||!a.data){_("Invalid export file format. Missing required fields.");return}let t=Object.keys(a.data),s={},l=0;for(let e of t){let r=Array.isArray(a.data[e])?a.data[e].length:0;s[e]=r,l+=r}y({version:a.version,exportedAt:a.exportedAt,tables:t,recordCounts:s,totalRecords:l}),h(e),x("preview")}catch(e){e instanceof SyntaxError?_("Invalid JSON file. Please select a valid export file."):_("Failed to read file. Please try again.")}},D=async()=>{if(p&&b){x("importing"),v(null),f(null);try{let e=await p.text(),a=JSON.parse(e),t=await K.hi.importExport.importData(a,g);f(t),x("result"),await S(),r&&r()}catch(e){v(e instanceof Error?e.message:"Import failed"),x("result")}}},L=()=>{x("select"),h(null),y(null),f(null),v(null),_(null),C.current&&(C.current.value="")},P=(0,s.useCallback)(e=>{e.preventDefault();let r=e.dataTransfer.files[0];r&&F(r)},[]),E=(0,s.useCallback)(e=>{e.preventDefault()},[]);return t.jsx("div",{className:"bg-white rounded-lg shadow-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Data Management"}),e&&t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("hr",{className:"border-gray-200"}),(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:"Export Data"}),l&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Current Database"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-2xl font-bold text-gray-900",children:H(l.totalRecords)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Total Records"})]}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-2xl font-bold text-blue-600",children:H(l.tableStats.projects||0)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Projects"})]}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-2xl font-bold text-green-600",children:H(l.tableStats.tasks||0)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Tasks"})]}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"text-2xl font-bold text-purple-600",children:H(l.tableStats.people||0)}),t.jsx("p",{className:"text-xs text-gray-500",children:"People"})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx("button",{onClick:W,disabled:i,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Exporting..."]}):(0,t.jsxs)(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Data (JSON)"]})}),(0,t.jsxs)("button",{onClick:Z,disabled:i,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors border border-gray-300",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),"Export Database (.db)"]})]}),o&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Last export: ",Q(o)]})]}),t.jsx("hr",{className:"border-gray-200"}),(()=>{switch(m){case"select":return(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:"Import Data"}),(0,t.jsxs)("div",{onDrop:P,onDragOver:E,onClick:()=>C.current?.click(),className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("span",{className:"text-blue-600 font-medium",children:"Click to upload"})," or drag and drop"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JSON export file only"}),t.jsx("input",{ref:C,type:"file",accept:".json",onChange:M,className:"hidden","aria-label":"Select export file"})]}),w&&(0,t.jsxs)("div",{className:"bg-red-50 text-red-700 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w]})]});case"preview":return(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:"Import Preview"}),b&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:p?.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Exported: ",Q(b.exportedAt)]})]}),(0,t.jsxs)("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:["v",b.version]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[H(b.totalRecords)," records to import"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:b.tables.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 bg-white px-2 py-1 rounded text-xs border",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[Y(e),":"]}),t.jsx("span",{className:"font-medium",children:H(b.recordCounts[e])})]},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Import Mode"}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border cursor-pointer hover:bg-gray-50 transition-colors has-[:checked]:border-blue-500 has-[:checked]:bg-blue-50",children:[t.jsx("input",{type:"radio",name:"importMode",value:"merge",checked:"merge"===g,onChange:()=>u("merge"),className:"mt-1"}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"font-medium text-gray-900",children:"Merge"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Add new records, keep existing ones unchanged. Recommended for most cases."})]})]}),(0,t.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border cursor-pointer hover:bg-gray-50 transition-colors has-[:checked]:border-red-500 has-[:checked]:bg-red-50",children:[t.jsx("input",{type:"radio",name:"importMode",value:"replace",checked:"replace"===g,onChange:()=>u("replace"),className:"mt-1"}),(0,t.jsxs)("div",{children:[t.jsx("span",{className:"font-medium text-gray-900",children:"Replace"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Delete all existing data before import. This cannot be undone!"})]})]})]})]}),"replace"===g&&(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[t.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsx("span",{children:"Warning: Replace mode will permanently delete all existing data before importing. This action cannot be undone."})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:L,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),t.jsx("button",{onClick:D,className:`flex-1 px-4 py-2 rounded-lg transition-colors ${"replace"===g?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:"replace"===g?"Replace All Data":"Import Data"})]})]});case"importing":return(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("svg",{className:"animate-spin h-12 w-12 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),t.jsx("p",{className:"mt-4 text-lg font-medium text-gray-900",children:"Importing data..."}),t.jsx("p",{className:"text-sm text-gray-500",children:"Please wait while we process your data."})]});case"result":return t.jsx("div",{className:"space-y-4",children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-red-50 text-red-700 px-4 py-4 rounded-lg flex items-start gap-3",children:[t.jsx("svg",{className:"w-6 h-6 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:"Import Failed"}),t.jsx("p",{className:"text-sm mt-1",children:N})]})]}),t.jsx("button",{onClick:L,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Try Again"})]}):j&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-green-50 text-green-700 px-4 py-4 rounded-lg flex items-start gap-3",children:[t.jsx("svg",{className:"w-6 h-6 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-medium",children:"Import Complete"}),(0,t.jsxs)("p",{className:"text-sm mt-1",children:["Mode: ","merge"===j.mode?"Merge":"Replace"]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Import Summary"}),t.jsx("div",{className:"space-y-3",children:Object.entries(j.summary).map(([e,r])=>(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:Y(e)}),(0,t.jsxs)("div",{className:"flex gap-3",children:[r.imported>0&&(0,t.jsxs)("span",{className:"text-green-600",children:[r.imported," imported"]}),r.skipped>0&&(0,t.jsxs)("span",{className:"text-yellow-600",children:[r.skipped," skipped"]}),r.errors>0&&(0,t.jsxs)("span",{className:"text-red-600",children:[r.errors," errors"]})]})]},e))}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:[t.jsx("span",{className:"text-gray-900",children:"Total"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("span",{className:"text-green-600",children:[j.totals.imported," imported"]}),j.totals.skipped>0&&(0,t.jsxs)("span",{className:"text-yellow-600",children:[j.totals.skipped," skipped"]}),j.totals.errors>0&&(0,t.jsxs)("span",{className:"text-red-600",children:[j.totals.errors," errors"]})]})]})})]}),j.errorDetails&&j.errorDetails.length>0&&(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Some records had errors"}),(0,t.jsxs)("ul",{className:"text-xs text-yellow-700 space-y-1 max-h-32 overflow-y-auto",children:[j.errorDetails.slice(0,10).map((e,r)=>(0,t.jsxs)("li",{children:[Y(e.table)," (",e.id,"): ",e.error]},r)),j.errorDetails.length>10&&(0,t.jsxs)("li",{children:["...and ",j.errorDetails.length-10," more errors"]})]})]}),t.jsx("button",{onClick:e||L,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Done"})]})})}})()]})})}function ee({children:e}){let{modal:r,closeModal:a,openTaskModal:l,openProjectModal:d}=(0,m.qD)(),{createProject:i,updateProject:n,currentProject:o}=(0,x.Z0)(),{createTask:c,updateTask:g}=(0,f.Xi)(),[u,p]=(0,s.useState)(!1),h=(0,s.useCallback)(async e=>{p(!0);try{r.data?await n(r.data.id,e):await i(e),a()}catch(e){console.error("Failed to save project:",e)}finally{p(!1)}},[r.data,i,n,a]),b=(0,s.useCallback)(async e=>{p(!0);try{r.data?await g(r.data.id,e):await c(e),a()}catch(e){console.error("Failed to save task:",e)}finally{p(!1)}},[r.data,c,g,a]),y=(0,s.useCallback)(()=>{d()},[d]);return(0,t.jsxs)("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-gray-900",children:[t.jsx(q,{onAddProject:y}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[t.jsx(W,{}),t.jsx("main",{className:"flex-1 overflow-auto p-4 md:p-6",children:e})]}),t.jsx(A.u_,{isOpen:r.isOpen&&"project"===r.type,onClose:a,title:r.data?"Edit Project":"Create New Project",size:"md",children:t.jsx(J,{project:r.data,onSubmit:h,onCancel:a,isLoading:u})}),t.jsx(A.u_,{isOpen:r.isOpen&&"task"===r.type,onClose:a,title:r.data?"Edit Task":"Create New Task",size:"lg",children:t.jsx(X.t,{task:r.data,project:o,projectId:o?.id,onSubmit:b,onCancel:a,isLoading:u})}),t.jsx(A.u_,{isOpen:r.isOpen&&"importExport"===r.type,onClose:a,title:"Data Management",size:"lg",children:t.jsx(G,{onClose:a})})]})}},5342:(e,r,a)=>{a.d(r,{Fr:()=>s,MW:()=>l,RS:()=>t});let t={backlog:{label:"Backlog",color:"#6b7280"},todo:{label:"To Do",color:"#3b82f6"},in_progress:{label:"In Progress",color:"#f59e0b"},review:{label:"Review",color:"#8b5cf6"},done:{label:"Done",color:"#10b981"}},s={low:{label:"Low",color:"#6b7280"},medium:{label:"Medium",color:"#3b82f6"},high:{label:"High",color:"#f59e0b"},urgent:{label:"Urgent",color:"#ef4444"}},l=["#3B82F6","#10B981","#8B5CF6","#F59E0B","#EF4444","#EC4899","#14B8A6","#6366F1"]}};