"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[748],{36410:function(e,r,a){a.d(r,{OE:function(){return h},U2:function(){return f},eR:function(){return k}});var t=a(57437),s=a(2265),l=a(61994),d=a(53335),n=a(63639),i=a(20265),o=a(21047),c=a(15051);let m={default:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 outlined:bg-transparent outlined:border-gray-300 outlined:text-gray-700 dark:outlined:border-gray-600 dark:outlined:text-gray-300",primary:"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-400 outlined:bg-transparent outlined:border-primary-500 outlined:text-primary-600 dark:outlined:text-primary-400",success:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 outlined:bg-transparent outlined:border-green-500 outlined:text-green-600 dark:outlined:text-green-400",warning:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 outlined:bg-transparent outlined:border-amber-500 outlined:text-amber-600 dark:outlined:text-amber-400",danger:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 outlined:bg-transparent outlined:border-red-500 outlined:text-red-600 dark:outlined:text-red-400",info:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 outlined:bg-transparent outlined:border-blue-500 outlined:text-blue-600 dark:outlined:text-blue-400"},x={sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-0.5 text-xs",lg:"px-2.5 py-1 text-sm"},u=(0,s.forwardRef)((e,r)=>{let{className:a,children:s,variant:n="default",size:i="md",dot:o=!1,outlined:c=!1,...u}=e;return(0,t.jsxs)("span",{ref:r,className:(0,d.m6)((0,l.W)("inline-flex items-center font-medium rounded-full",m[n],x[i],c&&"border",a)),...u,children:[o&&(0,t.jsx)("span",{className:(0,l.W)("mr-1.5 h-1.5 w-1.5 rounded-full",{default:"bg-gray-500",primary:"bg-primary-500",success:"bg-green-500",warning:"bg-amber-500",danger:"bg-red-500",info:"bg-blue-500"}[n]),"aria-hidden":"true"}),s]})});u.displayName="Badge";let g={backlog:"default",todo:"primary",in_progress:"warning",review:"info",done:"success"},p={backlog:"Backlog",todo:"To Do",in_progress:"In Progress",review:"Review",done:"Done"},h=(0,s.forwardRef)((e,r)=>{let{status:a,children:s,...l}=e;return(0,t.jsx)(u,{ref:r,variant:g[a],dot:!0,...l,children:s||p[a]})});h.displayName="StatusBadge";let b={low:"default",medium:"primary",high:"warning",urgent:"danger"},y={low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},j={urgent:{icon:n.Z,colorClass:"text-red-600 dark:text-red-400",pattern:"Solid background"},high:{icon:i.Z,colorClass:"text-orange-600 dark:text-orange-400",pattern:"Diagonal lines"},medium:{icon:o.Z,colorClass:"text-blue-600 dark:text-blue-400",pattern:"Dotted"},low:{icon:c.Z,colorClass:"text-gray-600 dark:text-gray-400",pattern:"Striped"}},f=(0,s.forwardRef)((e,r)=>{let{priority:a,children:n,showIcon:i=!0,showLabel:o=!0,className:c,...u}=e,[g,p]=(0,s.useState)(!1),h=j[a],f=h.icon,k=n||y[a];return(0,t.jsxs)("span",{ref:r,className:(0,d.m6)((0,l.W)("inline-flex items-center font-medium rounded-full",m[b[a]],x.sm,"relative",c)),role:"img","aria-label":"Priority: ".concat(y[a]),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onFocus:()=>p(!0),onBlur:()=>p(!1),...u,children:[i&&(0,t.jsx)(f,{className:(0,d.m6)((0,l.W)("w-3 h-3 mr-1",h.colorClass)),"aria-hidden":"true"}),o&&(0,t.jsx)("span",{children:k}),g&&(0,t.jsxs)("span",{role:"tooltip",className:(0,d.m6)((0,l.W)("absolute bottom-full left-1/2 -translate-x-1/2 mb-2","px-2 py-1 text-xs whitespace-nowrap","bg-gray-900 dark:bg-gray-700 text-white","rounded-md shadow-lg","z-50","animate-fade-in")),children:[y[a]," Priority",(0,t.jsx)("span",{className:(0,d.m6)((0,l.W)("absolute top-full left-1/2 -translate-x-1/2","border-4 border-transparent","border-t-gray-900 dark:border-t-gray-700")),"aria-hidden":"true"})]})]})});f.displayName="PriorityBadge";let k=(0,s.forwardRef)((e,r)=>{let{tag:a,size:s="md",className:n,...i}=e,o=(e=>{let r=e.replace("#",""),a=parseInt(r.substr(0,2),16);return(.299*a+.587*parseInt(r.substr(2,2),16)+.114*parseInt(r.substr(4,2),16))/255>.5?"#1f2937":"#f9fafb"})(a.color);return(0,t.jsxs)("span",{ref:r,className:(0,d.m6)((0,l.W)("inline-flex items-center font-medium rounded-full",{sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-0.5 text-xs",lg:"px-2.5 py-1 text-sm"}[s],n)),style:{backgroundColor:a.color,color:o},...i,children:[(0,t.jsx)("span",{className:"mr-1.5 h-1.5 w-1.5 rounded-full",style:{backgroundColor:o},"aria-hidden":"true"}),a.name]})});k.displayName="TagBadge"},55867:function(e,r,a){a.d(r,{Pm:function(){return s}});var t=a(57437);function s(e){let{percent:r,color:a,className:s=""}=e,l=Math.min(100,Math.max(0,r));return(0,t.jsx)("div",{className:"h-1 w-full bg-gray-200 rounded-full overflow-hidden ".concat(s),role:"progressbar","aria-valuenow":l,"aria-valuemin":0,"aria-valuemax":100,children:(0,t.jsx)("div",{className:"h-full rounded-full transition-all duration-300 ".concat(a||(l>=100?"bg-green-500":l>=50?"bg-yellow-500":"bg-blue-500")),style:{width:"".concat(l,"%")}})})}a(2265)},54586:function(e,r,a){a.d(r,{t:function(){return W}});var t=a(57437),s=a(2265),l=a(61994),d=a(53335),n=a(13781),i=a(43044),o=a(46211),c=a(91723),m=a(92369),x=a(95805),u=a(32489),g=a(99397),p=a(62720),h=a(53793),b=a(31047),y=a(6481),j=a(14565),f=a(36410),k=a(55867);function v(e){let{field:r,value:a,onChange:s,disabled:l=!1,error:d}=e,n="custom-field-".concat(r.id),i="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white ".concat(d?"border-red-500":"border-gray-300 dark:border-gray-600"," ").concat(l?"opacity-50 cursor-not-allowed":""),o=e=>{s(r.id,e)};switch(r.field_type){case"text":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.name,r.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:n,value:a||"",onChange:e=>o(e.target.value||null),disabled:l,className:i,placeholder:"Enter ".concat(r.name.toLowerCase()),required:r.required}),d&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:d})]});case"number":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.name,r.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("input",{type:"number",id:n,value:null!=a?a:"",onChange:e=>{let r=e.target.value;o(r?parseFloat(r):null)},disabled:l,className:i,placeholder:"Enter ".concat(r.name.toLowerCase()),required:r.required,step:"any"}),d&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:d})]});case"date":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.name,r.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("input",{type:"date",id:n,value:a||"",onChange:e=>o(e.target.value||null),disabled:l,className:i,required:r.required}),d&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:d})]});case"select":var c;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.name,r.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("select",{id:n,value:a||"",onChange:e=>o(e.target.value||null),disabled:l,className:i,required:r.required,children:[(0,t.jsxs)("option",{value:"",children:["Select ",r.name.toLowerCase(),"..."]}),null===(c=r.options)||void 0===c?void 0:c.map((e,r)=>(0,t.jsx)("option",{value:e,children:e},r))]}),d&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:d})]});case"multiselect":return(0,t.jsx)(N,{field:r,value:a,onChange:o,disabled:l,error:d,inputId:n});case"checkbox":return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:n,checked:!!a,onChange:e=>o(e.target.checked),disabled:l,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",required:r.required}),(0,t.jsxs)("label",{htmlFor:n,className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[r.name,r.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),d&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:d})]});case"url":return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.name,r.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("input",{type:"url",id:n,value:a||"",onChange:e=>o(e.target.value||null),disabled:l,className:i,placeholder:"https://example.com",required:r.required}),d&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:d})]});default:return(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Unknown field type: ",r.field_type]})}}function N(e){var r;let{field:a,value:l,onChange:d,disabled:n,error:i,inputId:o}=e,[c,m]=(0,s.useState)(!1),x=(0,s.useRef)(null),u=l||[];(0,s.useEffect)(()=>{function e(e){x.current&&!x.current.contains(e.target)&&m(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let g=e=>{if(u.includes(e)){let r=u.filter(r=>r!==e);d(r.length>0?r:null)}else d([...u,e])},p=e=>{let r=u.filter(r=>r!==e);d(r.length>0?r:null)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[a.name,a.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("div",{ref:x,className:"relative",children:[(0,t.jsxs)("div",{className:"w-full min-h-[42px] px-3 py-2 border rounded-md shadow-sm cursor-pointer flex flex-wrap gap-1 items-center dark:bg-gray-700 ".concat(i?"border-red-500":"border-gray-300 dark:border-gray-600"," ").concat(n?"opacity-50 cursor-not-allowed":""),onClick:()=>!n&&m(!c),children:[0===u.length?(0,t.jsxs)("span",{className:"text-gray-400 dark:text-gray-500",children:["Select ",a.name.toLowerCase(),"..."]}):u.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-100 text-sm rounded-md",children:[e,(0,t.jsx)("button",{type:"button",onClick:r=>{r.stopPropagation(),p(e)},className:"text-blue-600 dark:text-blue-300 hover:text-blue-800 dark:hover:text-blue-100 focus:outline-none","aria-label":"Remove ".concat(e),children:(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e)),(0,t.jsx)("svg",{className:"w-4 h-4 ml-auto text-gray-400 transition-transform ".concat(c?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&!n&&(0,t.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:[null===(r=a.options)||void 0===r?void 0:r.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:u.includes(e),onChange:()=>g(e),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})]},e)),(!a.options||0===a.options.length)&&(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No options available"})]})]}),i&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:i})]})}var w=a(51339),_=a(32298),C=a(50588),S=a(32464);function W(e){var r,a;let{task:N,project:W,projectId:E,parentTaskId:M,onSubmit:Z,onCancel:F,isLoading:L=!1}=e,D=!!N,P=(null==N?void 0:N.project_id)||E||(null==W?void 0:W.id),{projectPeople:T,people:A}=(0,w.u$)(),{availableTags:q}=(0,_.e0)(),{tasks:B}=(0,C.Xi)(),{availableFields:I,fetchCustomFields:O,fetchTaskCustomFields:z,setTaskCustomField:R,getTaskFieldValue:U}=(0,S.mZ)(),[V,J]=(0,s.useState)(new Map),X=(0,s.useMemo)(()=>P?B.filter(e=>e.project_id===P&&e.id!==(null==N?void 0:N.id)):[],[B,P,null==N?void 0:N.id]),K=(0,s.useMemo)(()=>P?A.filter(e=>!e.project_id||e.project_id===P):A,[A,P]),H=(0,s.useMemo)(()=>q,[q]),[$,Q]=(0,s.useState)({title:(null==N?void 0:N.title)||"",description:(null==N?void 0:N.description)||"",status:(null==N?void 0:N.status)||"todo",priority:(null==N?void 0:N.priority)||"medium",due_date:(null==N?void 0:N.due_date)?N.due_date.split("T")[0]:"",start_date:(null==N?void 0:N.start_date)?N.start_date.split("T")[0]:"",assignee_id:(null==N?void 0:N.assignee_id)||null,parent_task_id:(null==N?void 0:N.parent_task_id)||M||null,progress_percent:(null==N?void 0:N.progress_percent)||0,estimated_duration_minutes:(null==N?void 0:N.estimated_duration_minutes)||0,actual_duration_minutes:(null==N?void 0:N.actual_duration_minutes)||0}),[Y,G]=(0,s.useState)([]),[ee,er]=(0,s.useState)([]),[ea,et]=(0,s.useState)(!1),[es,el]=(0,s.useState)(!1),[ed,en]=(0,s.useState)({});(0,s.useEffect)(()=>{N&&(Q({title:N.title,description:N.description,status:N.status,priority:N.priority,due_date:N.due_date?N.due_date.split("T")[0]:"",start_date:N.start_date?N.start_date.split("T")[0]:"",assignee_id:N.assignee_id||null,parent_task_id:N.parent_task_id||M||null,progress_percent:N.progress_percent||0,estimated_duration_minutes:N.estimated_duration_minutes||0,actual_duration_minutes:N.actual_duration_minutes||0}),N.coAssignees&&N.coAssignees.length>0&&G(N.coAssignees.map(e=>e.person).filter(e=>void 0!==e)),N.tags&&N.tags.length>0&&er(N.tags.map(e=>e.tag).filter(e=>void 0!==e)))},[N,M]),(0,s.useEffect)(()=>{P?O(String(P)):O()},[P,O]),(0,s.useEffect)(()=>{N&&I.length>0&&z(N.id)},[N,I,z]),(0,s.useEffect)(()=>{if(N&&I.length>0){let e=new Map;I.forEach(r=>{let a=U(N.id,r.id);a&&e.set(r.id,a.value)}),J(e)}},[N,I,U]);let ei=()=>{let e={};return $.title.trim()?$.title.length>200&&(e.title="Task title must be less than 200 characters"):e.title="Task title is required",$.description.length>2e3&&(e.description="Description must be less than 2000 characters"),$.start_date&&$.due_date&&new Date($.start_date)>new Date($.due_date)&&(e.start_date="Start date cannot be after due date",e.due_date="Due date cannot be before start date"),en(e),0===Object.keys(e).length},eo=async e=>{if(e.preventDefault(),ei())try{let e={title:$.title.trim(),description:$.description.trim(),status:$.status,priority:$.priority,due_date:$.due_date||null,start_date:$.start_date||null,assignee_id:$.assignee_id||void 0,parent_task_id:$.parent_task_id||null,progress_percent:$.progress_percent,estimated_duration_minutes:$.estimated_duration_minutes||void 0,actual_duration_minutes:$.actual_duration_minutes||void 0,...D?{}:{project_id:P,tag_ids:ee.map(e=>e.id),co_assignee_ids:Y.map(e=>e.id)}};if(await Z(e),null==N?void 0:N.id)for(let[e,r]of V)await R(N.id,e,r)}catch(e){}},ec=(e,r)=>{J(a=>{let t=new Map(a);return t.set(e,r),t})},em=e=>{let{name:r,value:a,type:t}=e.target;"assignee_id"===r?Q(e=>({...e,[r]:a?Number(a):null})):"parent_task_id"===r?Q(e=>({...e,[r]:a?Number(a):null})):"number"===t?Q(e=>({...e,[r]:Number(a)})):Q(e=>({...e,[r]:a})),ed[r]&&en(e=>({...e,[r]:void 0}))},ex=e=>{let r=K.find(r=>r.id===e);r&&!Y.find(r=>r.id===e)&&$.assignee_id!==e&&G(e=>[...e,r]),et(!1)},eu=e=>{G(r=>r.filter(r=>r.id!==e))},eg=e=>{let r=H.find(r=>r.id===e);r&&!ee.find(r=>r.id===e)&&er(e=>[...e,r]),el(!1)},ep=e=>{er(r=>r.filter(r=>r.id!==e))},eh=(0,s.useMemo)(()=>K.filter(e=>e.id!==$.assignee_id&&!Y.find(r=>r.id===e.id)),[K,$.assignee_id,Y]),eb=(0,s.useMemo)(()=>H.filter(e=>!ee.find(r=>r.id===e.id)),[H,ee]),ey=e=>{if(0===e)return"0m";let r=Math.floor(e/60),a=e%60;return 0===r?"".concat(a,"m"):0===a?"".concat(r,"h"):"".concat(r,"h ").concat(a,"m")};return(0,t.jsxs)("form",{onSubmit:eo,className:"space-y-4",children:[W&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 pb-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded",style:{backgroundColor:W.color}}),(0,t.jsx)("span",{children:W.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Task Title ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"title",name:"title",value:$.title,onChange:em,placeholder:"Enter task title",className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",ed.title?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:L,autoFocus:!0}),ed.title&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:ed.title})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:$.description,onChange:em,placeholder:"Enter task description (optional)",rows:3,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm resize-none","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",ed.description?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:L}),ed.description&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:ed.description}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[$.description.length,"/2000 characters"]})]}),X.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"parent_task_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4 inline-block mr-1"}),"Parent Task"]}),(0,t.jsxs)("select",{id:"parent_task_id",name:"parent_task_id",value:$.parent_task_id||"",onChange:em,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:L,children:[(0,t.jsx)("option",{value:"",children:"No parent task (top-level)"}),X.map(e=>(0,t.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(i.Z,{className:"w-4 h-4 inline-block mr-1"}),"Status"]}),(0,t.jsx)("select",{id:"status",name:"status",value:$.status,onChange:em,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:L,children:Object.entries(y.RS).map(e=>{let[r,a]=e;return(0,t.jsx)("option",{value:r,children:a.label},r)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 inline-block mr-1"}),"Priority"]}),(0,t.jsx)("select",{id:"priority",name:"priority",value:$.priority,onChange:em,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:L,children:Object.entries(y.Fr).map(e=>{let[r,a]=e;return(0,t.jsx)("option",{value:r,children:a.label},r)})})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800/50 rounded-md space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4 inline-block mr-1"}),"Progress & Duration"]}),$.progress_percent>0&&(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:[$.progress_percent,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("input",{type:"range",id:"progress_percent",name:"progress_percent",min:"0",max:"100",value:$.progress_percent,onChange:em,className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:L}),(0,t.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400 w-12 text-right",children:[$.progress_percent,"%"]})]}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(k.Pm,{percent:$.progress_percent})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"estimated_duration_minutes",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Estimated (minutes)"}),(0,t.jsx)("input",{type:"number",id:"estimated_duration_minutes",name:"estimated_duration_minutes",min:"0",step:"15",value:$.estimated_duration_minutes,onChange:em,placeholder:"0",className:(0,d.m6)((0,l.W)("w-full px-3 py-1.5 rounded-md border shadow-sm text-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:L}),$.estimated_duration_minutes>0&&(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["= ",ey($.estimated_duration_minutes)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"actual_duration_minutes",className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Actual (minutes)"}),(0,t.jsx)("input",{type:"number",id:"actual_duration_minutes",name:"actual_duration_minutes",min:"0",step:"15",value:$.actual_duration_minutes,onChange:em,placeholder:"0",className:(0,d.m6)((0,l.W)("w-full px-3 py-1.5 rounded-md border shadow-sm text-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:L}),$.actual_duration_minutes>0&&(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["= ",ey($.actual_duration_minutes)]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"assignee_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 inline-block mr-1"}),"Primary Assignee"]}),(0,t.jsxs)("select",{id:"assignee_id",name:"assignee_id",value:$.assignee_id||"",onChange:em,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:L,children:[(0,t.jsx)("option",{value:"",children:"Unassigned"}),K.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name,e.designation&&" (".concat(e.designation,")")]},e.id))]}),$.assignee_id&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-primary-600 dark:text-primary-400 text-xs font-medium",children:null===(r=K.find(e=>e.id===$.assignee_id))||void 0===r?void 0:r.name.charAt(0).toUpperCase()})}),(0,t.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:null===(a=K.find(e=>e.id===$.assignee_id))||void 0===a?void 0:a.name})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(x.Z,{className:"w-4 h-4 inline-block mr-1"}),"Co-Assignees"]}),Y.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:Y.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded-md",children:[(0,t.jsx)("div",{className:"w-5 h-5 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-primary-600 dark:text-primary-400 text-xs font-medium",children:e.name.charAt(0).toUpperCase()})}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name}),(0,t.jsx)("button",{type:"button",onClick:()=>eu(e.id),className:"ml-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",disabled:L,children:(0,t.jsx)(u.Z,{className:"w-3 h-3"})})]},e.id))}),eh.length>0&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>et(!ea),className:(0,d.m6)((0,l.W)("flex items-center gap-1 px-3 py-1.5 text-sm rounded-md border border-dashed","text-gray-500 dark:text-gray-400","hover:border-gray-400 dark:hover:border-gray-500","hover:text-gray-700 dark:hover:text-gray-300","border-gray-300 dark:border-gray-600")),disabled:L,children:[(0,t.jsx)(g.Z,{className:"w-4 h-4"}),"Add co-assignee"]}),ea&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>et(!1)}),(0,t.jsx)("div",{className:"absolute left-0 top-full mt-1 w-64 max-h-48 overflow-y-auto bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:eh.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>ex(e.id),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-primary-600 dark:text-primary-400 text-xs font-medium",children:e.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-900 dark:text-gray-100",children:e.name}),e.designation&&(0,t.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.designation})]})]},e.id))})]})]}),0===eh.length&&0===Y.length&&(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No additional people available"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 inline-block mr-1"}),"Tags"]}),ee.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:ee.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(f.eR,{tag:e,size:"sm"}),(0,t.jsx)("button",{type:"button",onClick:()=>ep(e.id),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",disabled:L,children:(0,t.jsx)(u.Z,{className:"w-3 h-3"})})]},e.id))}),eb.length>0&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>el(!es),className:(0,d.m6)((0,l.W)("flex items-center gap-1 px-3 py-1.5 text-sm rounded-md border border-dashed","text-gray-500 dark:text-gray-400","hover:border-gray-400 dark:hover:border-gray-500","hover:text-gray-700 dark:hover:text-gray-300","border-gray-300 dark:border-gray-600")),disabled:L,children:[(0,t.jsx)(g.Z,{className:"w-4 h-4"}),"Add tag"]}),es&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>el(!1)}),(0,t.jsx)("div",{className:"absolute left-0 top-full mt-1 w-48 max-h-48 overflow-y-auto bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:eb.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>eg(e.id),className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"text-gray-900 dark:text-gray-100",children:e.name})]},e.id))})]})]}),0===eb.length&&0===ee.length&&(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No tags available"})]}),I.length>0&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 inline-block mr-1"}),"Custom Fields"]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800/50 rounded-md space-y-3",children:I.map(e=>(0,t.jsx)(v,{field:e,value:V.get(e.id),onChange:r=>ec(e.id,r),disabled:L},e.id))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 inline-block mr-1"}),"Start Date"]}),(0,t.jsx)("input",{type:"date",id:"start_date",name:"start_date",value:$.start_date,onChange:em,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",ed.start_date?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:L}),ed.start_date&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:ed.start_date})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"due_date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 inline-block mr-1"}),"Due Date"]}),(0,t.jsx)("input",{type:"date",id:"due_date",name:"due_date",value:$.due_date,onChange:em,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg:white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",ed.due_date?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:L}),ed.due_date&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:ed.due_date})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsx)(j.z,{type:"button",variant:"secondary",onClick:F,disabled:L,children:"Cancel"}),(0,t.jsx)(j.z,{type:"submit",variant:"primary",isLoading:L,leftIcon:L?void 0:(0,t.jsx)(i.Z,{className:"w-4 h-4"}),children:D?"Update Task":"Create Task"})]})]})}},58748:function(e,r,a){a.d(r,{A:function(){return ee}});var t=a(57437),s=a(2265),l=a(61994),d=a(53335),n=a(58293),i=a(85929),o=a(97226),c=a(56266),m=a(45553),x=a(94217),u=a(56475),g=a(40875),p=a(22135),h=a(15863),b=a(99397),y=a(46211),j=a(31047),f=a(50588),k=a(92646),v=a(5050);let N={urgent:{label:"Urgent",color:"text-red-500"},high:{label:"High",color:"text-orange-500"},medium:{label:"Medium",color:"text-blue-500"},low:{label:"Low",color:"text-gray-500"}};function w(e){let{className:r}=e,[a,n]=(0,s.useState)(""),[i,o]=(0,s.useState)(null),[c,m]=(0,s.useState)("medium"),[w,_]=(0,s.useState)(""),[C,S]=(0,s.useState)(!1),[W,E]=(0,s.useState)(!1),[M,Z]=(0,s.useState)(!1),[F,L]=(0,s.useState)(!1),D=(0,s.useRef)(null),P=(0,s.useRef)(null),T=(0,s.useRef)(null),{createTask:A}=(0,f.Xi)(),{projects:q,currentProject:B}=(0,x.Z0)(),{showToast:I}=(0,k.pm)(),{registerShortcut:O,unregisterShortcut:z}=(0,v.XU)(),R=i||(null==B?void 0:B.id),U=q.find(e=>e.id===R);(0,s.useEffect)(()=>{let e="quick-add-task-focus";return O({id:e,key:"n",description:"Focus quick add task input",category:"Tasks",action:()=>{D.current&&D.current.focus()}}),()=>{z(e)}},[O,z]),(0,s.useEffect)(()=>{let e=e=>{P.current&&!P.current.contains(e.target)&&Z(!1),T.current&&!T.current.contains(e.target)&&L(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let V=(0,s.useCallback)(async e=>{if(null==e||e.preventDefault(),!a.trim()){I("Please enter a task title","warning");return}if(!R){I("Please select a project first","warning");return}E(!0);try{await A({title:a.trim(),project_id:R,status:"todo",priority:c,due_date:w||void 0}),I("Task created successfully","success"),n(""),_(""),m("medium"),S(!1)}catch(e){I("Failed to create task","error"),console.error("Failed to create task:",e)}finally{E(!1)}},[a,R,c,w,A,I]);return(0,t.jsx)("div",{className:(0,d.m6)((0,l.W)("relative",r)),children:(0,t.jsxs)("form",{onSubmit:V,className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"relative flex-1",children:(0,t.jsx)("input",{ref:D,type:"text",value:a,onChange:e=>n(e.target.value),onKeyDown:e=>{if("Enter"!==e.key||e.shiftKey||(e.preventDefault(),V()),"Escape"===e.key){var r;null===(r=D.current)||void 0===r||r.blur(),Z(!1),L(!1)}},placeholder:"Quick add task... (Press Enter)",disabled:W,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 text-sm rounded-lg border","bg-gray-50 dark:bg-gray-700","border-gray-200 dark:border-gray-600","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-blue-500","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Quick add task"})}),(0,t.jsxs)("div",{className:"relative",ref:P,children:[(0,t.jsxs)("button",{type:"button",onClick:()=>Z(!M),disabled:W,className:(0,d.m6)((0,l.W)("flex items-center gap-1 px-2 py-2 text-sm rounded-lg border","bg-gray-50 dark:bg-gray-700","border-gray-200 dark:border-gray-600","text-gray-700 dark:text-gray-300","hover:bg-gray-100 dark:hover:bg-gray-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Select project","aria-expanded":M,"aria-haspopup":"listbox",children:[U?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-sm",style:{backgroundColor:U.color},"aria-hidden":"true"}),(0,t.jsx)("span",{className:"hidden sm:inline max-w-[100px] truncate",children:U.name})]}):(0,t.jsx)(u.Z,{className:"w-4 h-4"}),(0,t.jsx)(g.Z,{className:(0,d.m6)((0,l.W)("w-3 h-3 transition-transform",M&&"rotate-180"))})]}),M&&(0,t.jsx)("div",{role:"listbox",className:(0,d.m6)((0,l.W)("absolute top-full right-0 mt-1 z-50","min-w-[200px] max-h-[300px] overflow-y-auto","bg-white dark:bg-gray-800","border border-gray-200 dark:border-gray-700","rounded-lg shadow-lg","py-1")),children:0===q.length?(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No projects available"}):q.map(e=>(0,t.jsxs)("button",{type:"button",role:"option","aria-selected":R===e.id,onClick:()=>{o(e.id),Z(!1)},className:(0,d.m6)((0,l.W)("w-full flex items-center gap-2 px-3 py-2 text-sm text-left","hover:bg-gray-100 dark:hover:bg-gray-700",R===e.id&&"bg-blue-50 dark:bg-blue-900/30")),children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-sm flex-shrink-0",style:{backgroundColor:e.color},"aria-hidden":"true"}),(0,t.jsx)("span",{className:"truncate",children:e.name})]},e.id))})]}),(0,t.jsx)("button",{type:"button",onClick:()=>S(!C),disabled:W,className:(0,d.m6)((0,l.W)("p-2 text-sm rounded-lg border","bg-gray-50 dark:bg-gray-700","border-gray-200 dark:border-gray-600","text-gray-500 dark:text-gray-400","hover:bg-gray-100 dark:hover:bg-gray-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":C?"Collapse options":"Expand options","aria-expanded":C,children:C?(0,t.jsx)(p.Z,{className:"w-4 h-4"}):(0,t.jsx)(g.Z,{className:"w-4 h-4"})}),(0,t.jsx)("button",{type:"submit",disabled:W||!a.trim(),className:(0,d.m6)((0,l.W)("flex items-center justify-center p-2 text-sm rounded-lg","bg-blue-500 hover:bg-blue-600","text-white","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Add task",children:W?(0,t.jsx)(h.Z,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(b.Z,{className:"w-4 h-4"})})]}),C&&(0,t.jsxs)("div",{className:"flex items-center gap-2 pl-1",children:[(0,t.jsxs)("div",{className:"relative",ref:T,children:[(0,t.jsxs)("button",{type:"button",onClick:()=>L(!F),disabled:W,className:(0,d.m6)((0,l.W)("flex items-center gap-1.5 px-2 py-1.5 text-xs rounded-md","bg-gray-100 dark:bg-gray-700","text-gray-600 dark:text-gray-300","hover:bg-gray-200 dark:hover:bg-gray-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200")),"aria-label":"Select priority","aria-expanded":F,"aria-haspopup":"listbox",children:[(0,t.jsx)(y.Z,{className:(0,d.m6)("w-3.5 h-3.5",N[c].color)}),(0,t.jsx)("span",{children:N[c].label}),(0,t.jsx)(g.Z,{className:(0,d.m6)((0,l.W)("w-3 h-3 transition-transform",F&&"rotate-180"))})]}),F&&(0,t.jsx)("div",{role:"listbox",className:(0,d.m6)((0,l.W)("absolute top-full left-0 mt-1 z-50","min-w-[120px]","bg-white dark:bg-gray-800","border border-gray-200 dark:border-gray-700","rounded-lg shadow-lg","py-1")),children:Object.keys(N).map(e=>(0,t.jsxs)("button",{type:"button",role:"option","aria-selected":c===e,onClick:()=>{m(e),L(!1)},className:(0,d.m6)((0,l.W)("w-full flex items-center gap-2 px-3 py-1.5 text-xs text-left","hover:bg-gray-100 dark:hover:bg-gray-700",c===e&&"bg-blue-50 dark:bg-blue-900/30")),children:[(0,t.jsx)(y.Z,{className:(0,d.m6)("w-3.5 h-3.5",N[e].color)}),(0,t.jsx)("span",{children:N[e].label})]},e))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(j.Z,{className:"w-3.5 h-3.5 text-gray-400"}),(0,t.jsx)("input",{type:"date",value:w,onChange:e=>_(e.target.value),disabled:W,className:(0,d.m6)((0,l.W)("px-2 py-1.5 text-xs rounded-md","bg-gray-100 dark:bg-gray-700","text-gray-600 dark:text-gray-300","border-0","focus:outline-none focus:ring-1 focus:ring-blue-500","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors duration-200","[color-scheme:light] dark:[color-scheme:dark]")),"aria-label":"Due date"})]})]})]})})}let _=()=>(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),C=()=>(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})});function S(e){let{taskTitle:r,maxItems:a=4,className:l=""}=e,{projects:d}=(0,x.Z0)(),{selectedProject:n,selectProject:i}=(0,x.C1)(),{setCurrentView:o}=(0,m.qD)(),c=(0,s.useMemo)(()=>{let e=[];if(e.push({id:"root",label:"Projects",isCurrent:!n&&!r,onClick:()=>{o("dashboard")}}),n){let a=d.find(e=>String(e.id)===n);if(a){let t=[...(0,x.LZ)(d,a.id),a];t.forEach((a,s)=>{let l=s===t.length-1&&!r;e.push({id:String(a.id),label:a.name,color:a.color,isCurrent:l,onClick:()=>{i(String(a.id)),o("kanban")}})})}}return r&&e.push({id:"task",label:r,isCurrent:!0}),e},[d,n,r,o,i]),u=(0,s.useMemo)(()=>c.length<=a?c:[c[0],"ellipsis",...c.slice(-(a-2))],[c,a]);return c.length<=1&&!r?null:(0,t.jsx)("nav",{className:"flex items-center gap-1 text-sm ".concat(l),"aria-label":"Breadcrumb",children:(0,t.jsx)("ol",{className:"flex items-center gap-1 flex-wrap",children:u.map((e,r)=>"ellipsis"===e?(0,t.jsxs)("li",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-gray-400 px-1",children:"â€¦"}),(0,t.jsx)(_,{})]},"ellipsis"):(0,t.jsxs)("li",{className:"flex items-center gap-1",children:[r>0&&(0,t.jsx)(_,{}),e.isCurrent?(0,t.jsx)("span",{className:"font-semibold text-gray-900 truncate max-w-[200px]",title:e.label,style:e.color?{color:e.color}:void 0,children:e.label}):(0,t.jsxs)("button",{onClick:e.onClick,className:"text-gray-500 hover:text-gray-700 hover:underline transition-colors truncate max-w-[150px] flex items-center gap-1",title:e.label,children:["root"===e.id&&(0,t.jsx)(C,{}),e.color&&(0,t.jsx)("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"truncate",children:e.label})]})]},e.id))})})}function W(){let{sidebarOpen:e,toggleSidebar:r,darkMode:a,toggleDarkMode:s,currentView:u}=(0,m.qD)(),{currentProject:g}=(0,x.Z0)();return(0,t.jsxs)("header",{className:"sticky top-0 z-30 flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:r,className:(0,d.m6)((0,l.W)("p-2 rounded-md text-gray-500 hover:text-gray-700","dark:text-gray-400 dark:hover:text-gray-200","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-200","lg:hidden")),"aria-label":e?"Close sidebar":"Open sidebar",children:(0,t.jsx)(n.Z,{className:"w-5 h-5"})}),(0,t.jsx)("div",{className:"hidden md:block",children:(0,t.jsx)(S,{})}),(0,t.jsxs)("div",{className:"flex flex-col md:hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[g&&(0,t.jsx)("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:g.color},"aria-hidden":"true"}),(0,t.jsx)("h1",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:(null==g?void 0:g.name)||"Task Tracking"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:{kanban:"Kanban Board",list:"List View",calendar:"Calendar",timeline:"Timeline",dashboard:"Dashboard"}[u]||"Tasks"})]})]}),(0,t.jsx)("div",{className:"hidden md:flex flex-1 max-w-xl mx-4",children:(0,t.jsx)(w,{className:"w-full"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:s,className:(0,d.m6)((0,l.W)("p-2 rounded-md text-gray-500 hover:text-gray-700","dark:text-gray-400 dark:hover:text-gray-200","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-200")),"aria-label":a?"Switch to light mode":"Switch to dark mode",children:a?(0,t.jsx)(i.Z,{className:"w-5 h-5"}):(0,t.jsx)(o.Z,{className:"w-5 h-5"})}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("button",{className:(0,d.m6)((0,l.W)("p-2 rounded-md text-gray-500 hover:text-gray-700","dark:text-gray-400 dark:hover:text-gray-200","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-200")),"aria-label":"More options",children:(0,t.jsx)(c.Z,{className:"w-5 h-5"})})})]})]})}var E=a(99376),M=a(63307),Z=a(7586),F=a(99954),L=a(25466),D=a(32489),P=a(95805),T=a(49465),A=a(10407),q=a(51339);let B=[{id:"kanban",label:"Kanban",icon:(0,t.jsx)(M.Z,{className:"w-4 h-4"})},{id:"list",label:"List",icon:(0,t.jsx)(Z.Z,{className:"w-4 h-4"})},{id:"calendar",label:"Calendar",icon:(0,t.jsx)(j.Z,{className:"w-4 h-4"})},{id:"timeline",label:"Timeline",icon:(0,t.jsx)(F.Z,{className:"w-4 h-4"})},{id:"dashboard",label:"Dashboard",icon:(0,t.jsx)(L.Z,{className:"w-4 h-4"})}];function I(e){var r;let{onAddProject:a}=e,n=(0,E.useParams)(),i=null==n?void 0:n.projectId,o=(0,E.useRouter)(),c=(0,E.usePathname)(),{sidebarOpen:u,setSidebarOpen:g,currentView:p,setCurrentView:h,setCurrentProjectId:b}=(0,m.qD)(),{projects:y,currentProject:j,setCurrentProject:f}=(0,x.Z0)(),{people:k}=(0,q.u$)(),v=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(i){let e=parseInt(i,10);isNaN(e)||b(e)}},[i,b]);let N=e=>{f(e),b(e.id),o.push("/projects/".concat(e.id,"/").concat(p)),window.innerWidth<1024&&g(!1)},w=e=>{h(e),j&&o.push("/projects/".concat(j.id,"/").concat(e)),window.innerWidth<1024&&g(!1)};(0,s.useEffect)(()=>{let e=e=>{window.innerWidth<1024&&u&&v.current&&!v.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u,g]);let _=e=>e.owner_id?k.find(r=>r.id===e.owner_id):null,C=null!==(r=null==c?void 0:c.startsWith("/people"))&&void 0!==r&&r,S=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-primary-500 flex items-center justify-center",children:(0,t.jsx)(M.Z,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"TaskTrack"})]}),(0,t.jsx)("button",{onClick:()=>g(!1),className:"p-1.5 rounded-md text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 lg:hidden","aria-label":"Close sidebar",children:(0,t.jsx)(D.Z,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h2",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2",children:"Views"}),(0,t.jsx)("nav",{className:"space-y-1",children:B.map(e=>(0,t.jsxs)("button",{onClick:()=>w(e.id),className:(0,d.m6)((0,l.W)("w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium","transition-colors duration-200",p!==e.id||C?"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700":"bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-400")),children:[e.icon,e.label]},e.id))})]}),(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h2",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2",children:"Manage"}),(0,t.jsx)("nav",{className:"space-y-1",children:(0,t.jsxs)("button",{onClick:()=>{o.push("/people"),window.innerWidth<1024&&g(!1)},className:(0,d.m6)((0,l.W)("w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium","transition-colors duration-200",C?"bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-400":"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700")),children:[(0,t.jsx)(P.Z,{className:"w-4 h-4"}),"People"]})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 scrollbar-thin",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h2",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider",children:"Projects"}),a&&(0,t.jsx)("button",{onClick:a,className:"p-1 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Add project",children:(0,t.jsx)(T.Z,{className:"w-4 h-4"})})]}),0===y.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No projects yet"}),a&&(0,t.jsx)("button",{onClick:a,className:"mt-2 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400",children:"Create your first project"})]}):(0,t.jsx)("nav",{className:"space-y-1",children:y.map(e=>{var r,a;let s=_(e),n=(null==s?void 0:null===(a=s.name)||void 0===a?void 0:null===(r=a.charAt(0))||void 0===r?void 0:r.toUpperCase())||"?";return(0,t.jsxs)("button",{onClick:()=>N(e),className:(0,d.m6)((0,l.W)("w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium","transition-colors duration-200",(null==j?void 0:j.id)===e.id?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100":"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700")),children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-sm flex-shrink-0",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{className:"truncate flex-1 text-left",children:e.name}),s&&(0,t.jsx)("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-gray-100 dark:bg-gray-600 flex-shrink-0",title:"Owner: ".concat(s.name),children:(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-[10px] font-medium text-primary-600 dark:text-primary-400",children:n})})}),(null==j?void 0:j.id)===e.id&&(0,t.jsx)(A.Z,{className:"w-4 h-4 ml-auto text-gray-400"})]},e.id)})})]}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:(0,t.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:"Task Tracking v1.0.0"})})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("aside",{ref:v,className:(0,d.m6)((0,l.W)("hidden lg:flex flex-col w-64 h-screen","bg-white dark:bg-gray-800","border-r border-gray-200 dark:border-gray-700","transition-all duration-300 ease-in-out",!u&&"lg:w-0 lg:overflow-hidden")),children:S}),u&&(0,t.jsxs)("div",{className:"fixed inset-0 z-40 lg:hidden",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>g(!1)}),(0,t.jsx)("aside",{className:(0,d.m6)((0,l.W)("fixed inset-y-0 left-0 z-50","flex flex-col w-72 h-screen","bg-white dark:bg-gray-800","animate-slide-left")),children:S})]})]})}if("undefined"!=typeof document){let e=document.createElement("style");e.textContent="\n  @keyframes slideLeft {\n    from {\n      transform: translateX(-100%);\n    }\n    to {\n      transform: translateX(0);\n    }\n  }\n  \n  .animate-slide-left {\n    animation: slideLeft 0.3s ease-out;\n  }\n",document.head.appendChild(e)}var O=a(51776),z=a(13781),R=a(67815),U=a(6481),V=a(14565);function J(e){let{project:r,parentProjectId:a,onSubmit:n,onCancel:i,isLoading:o=!1}=e,c=!!r,{projects:m}=(0,x.Z0)(),{people:u}=(0,q.u$)(),g=(0,s.useMemo)(()=>m.filter(e=>e.id!==(null==r?void 0:r.id)),[m,null==r?void 0:r.id]),[p,h]=(0,s.useState)({name:(null==r?void 0:r.name)||"",description:(null==r?void 0:r.description)||"",color:(null==r?void 0:r.color)||U.MW[0],parent_project_id:(null==r?void 0:r.parent_project_id)||a||null,owner_id:(null==r?void 0:r.owner_id)||null}),[b,y]=(0,s.useState)({});(0,s.useEffect)(()=>{r&&h({name:r.name,description:r.description,color:r.color,parent_project_id:r.parent_project_id||null,owner_id:r.owner_id||null})},[r]);let j=()=>{let e={};return p.name.trim()?p.name.length>100&&(e.name="Project name must be less than 100 characters"):e.name="Project name is required",p.description.length>500&&(e.description="Description must be less than 500 characters"),y(e),0===Object.keys(e).length},f=async e=>{if(e.preventDefault(),j())try{c&&r?await n({name:p.name.trim(),description:p.description.trim(),color:p.color,parent_project_id:p.parent_project_id,owner_id:p.owner_id}):await n({name:p.name.trim(),description:p.description.trim(),color:p.color,parent_project_id:p.parent_project_id||void 0,owner_id:p.owner_id||void 0})}catch(e){}},k=e=>{let{name:r,value:a}=e.target;"parent_project_id"===r||"owner_id"===r?h(e=>({...e,[r]:a?Number(a):null})):h(e=>({...e,[r]:a})),b[r]&&y(e=>({...e,[r]:void 0}))},v=(0,s.useMemo)(()=>p.parent_project_id?m.find(e=>e.id===p.parent_project_id):null,[m,p.parent_project_id]),N=(0,s.useMemo)(()=>p.owner_id?u.find(e=>e.id===p.owner_id):null,[u,p.owner_id]);return(0,t.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[g.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"parent_project_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(z.Z,{className:"w-4 h-4 inline-block mr-1"}),"Parent Project"]}),(0,t.jsxs)("select",{id:"parent_project_id",name:"parent_project_id",value:p.parent_project_id||"",onChange:k,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:o,children:[(0,t.jsx)("option",{value:"",children:"No parent project (top-level)"}),g.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),v&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded",style:{backgroundColor:v.color}}),(0,t.jsxs)("span",{children:["Sub-project of: ",v.name]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"owner_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(R.Z,{className:"w-4 h-4 inline-block mr-1"}),"Project Owner"]}),(0,t.jsxs)("select",{id:"owner_id",name:"owner_id",value:p.owner_id||"",onChange:k,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:o,children:[(0,t.jsx)("option",{value:"",children:"No owner"}),u.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name,e.company?" (".concat(e.company,")"):""]},e.id))]}),N&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs font-medium text-primary-600 dark:text-primary-400",children:N.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("span",{children:["Owner: ",N.name]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Project Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:p.name,onChange:k,placeholder:"Enter project name",className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",b.name?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:o,autoFocus:!0}),b.name&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:b.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:p.description,onChange:k,placeholder:"Enter project description (optional)",rows:3,className:(0,d.m6)((0,l.W)("w-full px-3 py-2 rounded-md border shadow-sm resize-none","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",b.description?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:o}),b.description&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:b.description}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[p.description.length,"/500 characters"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:U.MW.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>h(r=>({...r,color:e})),className:(0,d.m6)((0,l.W)("w-8 h-8 rounded-full transition-all duration-200","hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2","dark:focus:ring-offset-gray-800",p.color===e&&"ring-2 ring-offset-2 ring-gray-400")),style:{backgroundColor:e},"aria-label":"Select color ".concat(e),disabled:o},e))}),(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:["Selected: ",(0,t.jsx)("span",{className:"font-mono",children:p.color})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:p.color},children:(0,t.jsx)(T.Z,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:p.name||"Project Name"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:p.description||"No description"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[p.parent_project_id&&v&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:[(0,t.jsx)(z.Z,{className:"w-3 h-3 inline-block mr-1"}),"Sub-project of ",v.name]}),N&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1",children:[(0,t.jsx)(R.Z,{className:"w-3 h-3 inline-block"}),"Owner: ",N.name]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsx)(V.z,{type:"button",variant:"secondary",onClick:i,disabled:o,children:"Cancel"}),(0,t.jsx)(V.z,{type:"submit",variant:"primary",isLoading:o,leftIcon:o?void 0:(0,t.jsx)(T.Z,{className:"w-4 h-4"}),children:c?"Update Project":"Create Project"})]})]})}var X=a(54586),K=a(28223);let H="taskflow-last-export";function $(e){return e.toLocaleString()}function Q(e){return new Date(e).toLocaleString()}function Y(e){return({projects:"Projects",tasks:"Tasks",people:"People",tags:"Tags",notes:"Notes",task_assignees:"Task Assignees",task_tags:"Task Tags",project_assignees:"Project Assignees",custom_fields:"Custom Fields",custom_field_values:"Custom Field Values",saved_views:"Saved Views"})[e]||e}function G(e){let{onClose:r,onImportComplete:a}=e,l=(0,k.pm)(),[d,n]=(0,s.useState)(null),[i,o]=(0,s.useState)(!1),[c,m]=(0,s.useState)(null),[x,u]=(0,s.useState)("select"),[g,p]=(0,s.useState)("merge"),[h,b]=(0,s.useState)(null),[y,j]=(0,s.useState)(null),[f,v]=(0,s.useState)(null),[N,w]=(0,s.useState)(null),[_,C]=(0,s.useState)(null),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{W();let e=localStorage.getItem(H);e&&m(e)},[]);let W=async()=>{try{let e=await K.hi.importExport.getExportStatus();n(e)}catch(e){console.error("Failed to load export status:",e)}},E=async()=>{o(!0);try{await K.hi.importExport.exportData();let e=new Date().toISOString();localStorage.setItem(H,e),m(e),l.success("Export Complete","Your data has been downloaded as a JSON file.")}catch(e){l.error("Export Failed",e instanceof Error?e.message:"Failed to export data")}finally{o(!1)}},M=async()=>{o(!0);try{await K.hi.importExport.exportSqlite(),l.success("Export Complete","Your database has been downloaded as a .db file.")}catch(e){l.error("Export Failed",e instanceof Error?e.message:"Failed to export database")}finally{o(!1)}},Z=(0,s.useCallback)(e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];a&&F(a)},[]),F=async e=>{if(C(null),j(null),b(null),!e.name.endsWith(".json")){C("Please select a valid JSON file");return}try{let r=await e.text(),a=JSON.parse(r);if(!a.version||!a.exportedAt||!a.data){C("Invalid export file format. Missing required fields.");return}let t=Object.keys(a.data),s={},l=0;for(let e of t){let r=Array.isArray(a.data[e])?a.data[e].length:0;s[e]=r,l+=r}j({version:a.version,exportedAt:a.exportedAt,tables:t,recordCounts:s,totalRecords:l}),b(e),u("preview")}catch(e){e instanceof SyntaxError?C("Invalid JSON file. Please select a valid export file."):C("Failed to read file. Please try again.")}},L=async()=>{if(h&&y){u("importing"),w(null),v(null);try{let e=await h.text(),r=JSON.parse(e),t=await K.hi.importExport.importData(r,g);v(t),u("result"),await W(),a&&a()}catch(e){w(e instanceof Error?e.message:"Import failed"),u("result")}}},D=()=>{u("select"),b(null),j(null),v(null),w(null),C(null),S.current&&(S.current.value="")},P=(0,s.useCallback)(e=>{e.preventDefault();let r=e.dataTransfer.files[0];r&&F(r)},[]),T=(0,s.useCallback)(e=>{e.preventDefault()},[]);return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Data Management"}),r&&(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("hr",{className:"border-gray-200"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:"Export Data"}),d&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Current Database"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:$(d.totalRecords)}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Total Records"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:$(d.tableStats.projects||0)}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Projects"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-green-600",children:$(d.tableStats.tasks||0)}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Tasks"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-purple-600",children:$(d.tableStats.people||0)}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"People"})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,t.jsx)("button",{onClick:E,disabled:i,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Exporting..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Data (JSON)"]})}),(0,t.jsxs)("button",{onClick:M,disabled:i,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors border border-gray-300",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),"Export Database (.db)"]})]}),c&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Last export: ",Q(c)]})]}),(0,t.jsx)("hr",{className:"border-gray-200"}),(()=>{switch(x){case"select":return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:"Import Data"}),(0,t.jsxs)("div",{onDrop:P,onDragOver:T,onClick:()=>{var e;return null===(e=S.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[(0,t.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:[(0,t.jsx)("span",{className:"text-blue-600 font-medium",children:"Click to upload"})," or drag and drop"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"JSON export file only"}),(0,t.jsx)("input",{ref:S,type:"file",accept:".json",onChange:Z,className:"hidden","aria-label":"Select export file"})]}),_&&(0,t.jsxs)("div",{className:"bg-red-50 text-red-700 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),_]})]});case"preview":return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:"Import Preview"}),y&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==h?void 0:h.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Exported: ",Q(y.exportedAt)]})]}),(0,t.jsxs)("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:["v",y.version]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[$(y.totalRecords)," records to import"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:y.tables.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 bg-white px-2 py-1 rounded text-xs border",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[Y(e),":"]}),(0,t.jsx)("span",{className:"font-medium",children:$(y.recordCounts[e])})]},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Import Mode"}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border cursor-pointer hover:bg-gray-50 transition-colors has-[:checked]:border-blue-500 has-[:checked]:bg-blue-50",children:[(0,t.jsx)("input",{type:"radio",name:"importMode",value:"merge",checked:"merge"===g,onChange:()=>p("merge"),className:"mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Merge"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Add new records, keep existing ones unchanged. Recommended for most cases."})]})]}),(0,t.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border cursor-pointer hover:bg-gray-50 transition-colors has-[:checked]:border-red-500 has-[:checked]:bg-red-50",children:[(0,t.jsx)("input",{type:"radio",name:"importMode",value:"replace",checked:"replace"===g,onChange:()=>p("replace"),className:"mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Replace"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Delete all existing data before import. This cannot be undone!"})]})]})]})]}),"replace"===g&&(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("span",{children:"Warning: Replace mode will permanently delete all existing data before importing. This action cannot be undone."})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:D,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:L,className:"flex-1 px-4 py-2 rounded-lg transition-colors ".concat("replace"===g?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"),children:"replace"===g?"Replace All Data":"Import Data"})]})]});case"importing":return(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("svg",{className:"animate-spin h-12 w-12 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),(0,t.jsx)("p",{className:"mt-4 text-lg font-medium text-gray-900",children:"Importing data..."}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Please wait while we process your data."})]});case"result":return(0,t.jsx)("div",{className:"space-y-4",children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-red-50 text-red-700 px-4 py-4 rounded-lg flex items-start gap-3",children:[(0,t.jsx)("svg",{className:"w-6 h-6 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Import Failed"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:N})]})]}),(0,t.jsx)("button",{onClick:D,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Try Again"})]}):f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-green-50 text-green-700 px-4 py-4 rounded-lg flex items-start gap-3",children:[(0,t.jsx)("svg",{className:"w-6 h-6 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Import Complete"}),(0,t.jsxs)("p",{className:"text-sm mt-1",children:["Mode: ","merge"===f.mode?"Merge":"Replace"]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Import Summary"}),(0,t.jsx)("div",{className:"space-y-3",children:Object.entries(f.summary).map(e=>{let[r,a]=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:Y(r)}),(0,t.jsxs)("div",{className:"flex gap-3",children:[a.imported>0&&(0,t.jsxs)("span",{className:"text-green-600",children:[a.imported," imported"]}),a.skipped>0&&(0,t.jsxs)("span",{className:"text-yellow-600",children:[a.skipped," skipped"]}),a.errors>0&&(0,t.jsxs)("span",{className:"text-red-600",children:[a.errors," errors"]})]})]},r)})}),(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:[(0,t.jsx)("span",{className:"text-gray-900",children:"Total"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("span",{className:"text-green-600",children:[f.totals.imported," imported"]}),f.totals.skipped>0&&(0,t.jsxs)("span",{className:"text-yellow-600",children:[f.totals.skipped," skipped"]}),f.totals.errors>0&&(0,t.jsxs)("span",{className:"text-red-600",children:[f.totals.errors," errors"]})]})]})})]}),f.errorDetails&&f.errorDetails.length>0&&(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Some records had errors"}),(0,t.jsxs)("ul",{className:"text-xs text-yellow-700 space-y-1 max-h-32 overflow-y-auto",children:[f.errorDetails.slice(0,10).map((e,r)=>(0,t.jsxs)("li",{children:[Y(e.table)," (",e.id,"): ",e.error]},r)),f.errorDetails.length>10&&(0,t.jsxs)("li",{children:["...and ",f.errorDetails.length-10," more errors"]})]})]}),(0,t.jsx)("button",{onClick:r||D,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Done"})]})})}})()]})})}function ee(e){let{children:r}=e,{modal:a,closeModal:l,openTaskModal:d,openProjectModal:n}=(0,m.qD)(),{createProject:i,updateProject:o,currentProject:c}=(0,x.Z0)(),{createTask:u,updateTask:g}=(0,f.Xi)(),[p,h]=(0,s.useState)(!1),b=(0,s.useCallback)(async e=>{h(!0);try{a.data?await o(a.data.id,e):await i(e),l()}catch(e){console.error("Failed to save project:",e)}finally{h(!1)}},[a.data,i,o,l]),y=(0,s.useCallback)(async e=>{h(!0);try{a.data?await g(a.data.id,e):await u(e),l()}catch(e){console.error("Failed to save task:",e)}finally{h(!1)}},[a.data,u,g,l]),j=(0,s.useCallback)(()=>{n()},[n]);return(0,t.jsxs)("div",{className:"flex h-screen overflow-hidden bg-gray-50 dark:bg-gray-900",children:[(0,t.jsx)(I,{onAddProject:j}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,t.jsx)(W,{}),(0,t.jsx)("main",{className:"flex-1 overflow-auto p-4 md:p-6",children:r})]}),(0,t.jsx)(O.u_,{isOpen:a.isOpen&&"project"===a.type,onClose:l,title:a.data?"Edit Project":"Create New Project",size:"md",children:(0,t.jsx)(J,{project:a.data,onSubmit:b,onCancel:l,isLoading:p})}),(0,t.jsx)(O.u_,{isOpen:a.isOpen&&"task"===a.type,onClose:l,title:a.data?"Edit Task":"Create New Task",size:"lg",children:(0,t.jsx)(X.t,{task:a.data,project:c,projectId:null==c?void 0:c.id,onSubmit:y,onCancel:l,isLoading:p})}),(0,t.jsx)(O.u_,{isOpen:a.isOpen&&"importExport"===a.type,onClose:l,title:"Data Management",size:"lg",children:(0,t.jsx)(G,{onClose:l})})]})}},6481:function(e,r,a){a.d(r,{Fr:function(){return s},MW:function(){return l},RS:function(){return t}});let t={backlog:{label:"Backlog",color:"#6b7280"},todo:{label:"To Do",color:"#3b82f6"},in_progress:{label:"In Progress",color:"#f59e0b"},review:{label:"Review",color:"#8b5cf6"},done:{label:"Done",color:"#10b981"}},s={low:{label:"Low",color:"#6b7280"},medium:{label:"Medium",color:"#3b82f6"},high:{label:"High",color:"#f59e0b"},urgent:{label:"Urgent",color:"#ef4444"}},l=["#3B82F6","#10B981","#8B5CF6","#F59E0B","#EF4444","#EC4899","#14B8A6","#6366F1"]}}]);