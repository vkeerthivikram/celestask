(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{47740:function(e,a,r){Promise.resolve().then(r.bind(r,7396))},7396:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return Z}});var t=r(57437),s=r(2265),l=r(58748),n=r(61994),i=r(53335),d=r(15863),o=r(95805),c=r(99397),m=r(73247),x=r(39763);let g=(0,x.Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),h=(0,x.Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);var y=r(18930);let p=(0,x.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),u=(0,x.Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),b=(0,x.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var j=r(51339),f=r(94217),k=r(51776),v=r(92369);let N=(0,x.Z)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),w=(0,x.Z)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var C=r(14565);function _(e){var a;let{person:r,projects:l=[],projectId:d,onSubmit:o,onCancel:c,isLoading:m=!1}=e,x=!!r,[g,h]=(0,s.useState)({name:(null==r?void 0:r.name)||"",email:(null==r?void 0:r.email)||"",company:(null==r?void 0:r.company)||"",designation:(null==r?void 0:r.designation)||"",project_id:(null==r?void 0:null===(a=r.project_id)||void 0===a?void 0:a.toString())||(null==d?void 0:d.toString())||""}),[y,b]=(0,s.useState)({});(0,s.useEffect)(()=>{if(r){var e;h({name:r.name,email:r.email||"",company:r.company||"",designation:r.designation||"",project_id:(null===(e=r.project_id)||void 0===e?void 0:e.toString())||""})}},[r]);let j=()=>{let e={};return g.name.trim()?g.name.length>100&&(e.name="Name must be less than 100 characters"):e.name="Name is required",g.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.email)&&(e.email="Please enter a valid email address"),g.company&&g.company.length>100&&(e.company="Company name must be less than 100 characters"),g.designation&&g.designation.length>100&&(e.designation="Designation must be less than 100 characters"),b(e),0===Object.keys(e).length},f=async e=>{if(e.preventDefault(),j())try{let e={name:g.name.trim(),email:g.email.trim()||void 0,company:g.company.trim()||void 0,designation:g.designation.trim()||void 0,project_id:g.project_id?parseInt(g.project_id,10):void 0};await o(e)}catch(e){}},k=e=>{let{name:a,value:r}=e.target;h(e=>({...e,[a]:r})),y[a]&&b(e=>({...e,[a]:void 0}))};return(0,t.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(v.Z,{className:"w-4 h-4 inline-block mr-1"}),"Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:g.name,onChange:k,placeholder:"Enter person's name",className:(0,i.m6)((0,n.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",y.name?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:m,autoFocus:!0}),y.name&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:y.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(p,{className:"w-4 h-4 inline-block mr-1"}),"Email"]}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:g.email,onChange:k,placeholder:"Enter email address (optional)",className:(0,i.m6)((0,n.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",y.email?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:m}),y.email&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:y.email})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(u,{className:"w-4 h-4 inline-block mr-1"}),"Company"]}),(0,t.jsx)("input",{type:"text",id:"company",name:"company",value:g.company,onChange:k,placeholder:"Company name (optional)",className:(0,i.m6)((0,n.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",y.company?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:m}),y.company&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:y.company})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"designation",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(N,{className:"w-4 h-4 inline-block mr-1"}),"Designation"]}),(0,t.jsx)("input",{type:"text",id:"designation",name:"designation",value:g.designation,onChange:k,placeholder:"Job title (optional)",className:(0,i.m6)((0,n.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",y.designation?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600")),disabled:m}),y.designation&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:y.designation})]})]}),l.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"project_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,t.jsx)(w,{className:"w-4 h-4 inline-block mr-1"}),"Project Assignment"]}),(0,t.jsxs)("select",{id:"project_id",name:"project_id",value:g.project_id,onChange:k,className:(0,i.m6)((0,n.W)("w-full px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),disabled:m,children:[(0,t.jsx)("option",{value:"",children:"Global (All Projects)"}),l.map(e=>(0,t.jsx)("option",{value:e.id.toString(),children:e.name},e.id))]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Select a project to make this person available only for that project, or leave as Global."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-primary-600 dark:text-primary-400 font-semibold text-sm",children:g.name?g.name.charAt(0).toUpperCase():"?"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:g.name||"Person Name"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:g.designation?g.company?"".concat(g.designation," at ").concat(g.company):g.designation:g.company||"No details"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsx)(C.z,{type:"button",variant:"secondary",onClick:c,disabled:m,children:"Cancel"}),(0,t.jsx)(C.z,{type:"submit",variant:"primary",isLoading:m,leftIcon:m?void 0:(0,t.jsx)(v.Z,{className:"w-4 h-4"}),children:x?"Update Person":"Add Person"})]})]})}function P(){let{people:e,loading:a,error:r,createPerson:l,updatePerson:x,deletePerson:g}=(0,j.u$)(),{projects:h}=(0,f.Z0)(),[y,p]=(0,s.useState)(""),[u,b]=(0,s.useState)(""),[v,N]=(0,s.useState)(!1),[w,P]=(0,s.useState)(null),[Z,M]=(0,s.useState)(null),[A,z]=(0,s.useState)(!1),F=(0,s.useMemo)(()=>{let a=[...e];if(y){let e=y.toLowerCase();a=a.filter(a=>{var r,t,s;return a.name.toLowerCase().includes(e)||(null===(r=a.email)||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(t=a.company)||void 0===t?void 0:t.toLowerCase().includes(e))||(null===(s=a.designation)||void 0===s?void 0:s.toLowerCase().includes(e))})}if("global"===u)a=a.filter(e=>!e.project_id);else if(u){let e=parseInt(u,10);a=a.filter(a=>a.project_id===e)}return a.sort((e,a)=>e.name.localeCompare(a.name)),a},[e,y,u]),L=(0,s.useCallback)(e=>{if(!e)return"Global";let a=h.find(a=>a.id===e);return(null==a?void 0:a.name)||"Unknown Project"},[h]),E=(0,s.useCallback)(e=>{if(!e)return"#6b7280";let a=h.find(a=>a.id===e);return(null==a?void 0:a.color)||"#6b7280"},[h]),D=async e=>{z(!0);try{await l(e),N(!1)}catch(e){console.error("Failed to create person:",e)}finally{z(!1)}},W=async e=>{if(w){z(!0);try{await x(w.id,e),P(null)}catch(e){console.error("Failed to update person:",e)}finally{z(!1)}}},G=async()=>{if(Z){z(!0);try{await g(Z.id),M(null)}catch(e){console.error("Failed to delete person:",e)}finally{z(!1)}}};return a?(0,t.jsx)("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.Z,{className:"w-8 h-8 text-primary-500 animate-spin mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading people..."})]})}):r?(0,t.jsx)("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center max-w-md p-6 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,t.jsx)("p",{className:"text-red-600 dark:text-red-400 mb-2",children:"Error loading people"}),(0,t.jsx)("p",{className:"text-sm text-red-500 dark:text-red-300",children:r})]})}):(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:(0,t.jsx)(o.Z,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"People"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.length," ",1===e.length?"person":"people"," total"]})]})]}),(0,t.jsx)(C.z,{variant:"primary",size:"sm",leftIcon:(0,t.jsx)(c.Z,{className:"w-4 h-4"}),onClick:()=>N(!0),children:"Add Person"})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(m.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Search people...",value:y,onChange:e=>p(e.target.value),className:(0,i.m6)((0,n.W)("w-full pl-10 pr-4 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","placeholder-gray-400 dark:placeholder-gray-500","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600"))})]}),(0,t.jsxs)("select",{value:u,onChange:e=>b(e.target.value),className:(0,i.m6)((0,n.W)("px-3 py-2 rounded-md border shadow-sm","bg-white dark:bg-gray-900","text-gray-900 dark:text-gray-100","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","border-gray-300 dark:border-gray-600")),children:[(0,t.jsx)("option",{value:"",children:"All People"}),(0,t.jsx)("option",{value:"global",children:"Global (All Projects)"}),h.map(e=>(0,t.jsx)("option",{value:e.id.toString(),children:e.name},e.id))]})]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-auto p-4",children:0===F.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-4",children:(0,t.jsx)(o.Z,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:0===e.length?"No people yet":"No people match your search"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 max-w-sm",children:0===e.length?"Add people to your team to start assigning them to tasks.":"Try adjusting your search or filter criteria."}),0===e.length&&(0,t.jsx)(C.z,{variant:"primary",size:"sm",className:"mt-4",leftIcon:(0,t.jsx)(c.Z,{className:"w-4 h-4"}),onClick:()=>N(!0),children:"Add First Person"})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:F.map(e=>(0,t.jsx)(S,{person:e,projectName:L(e.project_id),projectColor:E(e.project_id),onEdit:()=>P(e),onDelete:()=>M(e)},e.id))})}),(0,t.jsx)(k.u_,{isOpen:v,onClose:()=>N(!1),title:"Add Person",size:"md",children:(0,t.jsx)(_,{projects:h,onSubmit:D,onCancel:()=>N(!1),isLoading:A})}),(0,t.jsx)(k.u_,{isOpen:null!==w,onClose:()=>P(null),title:"Edit Person",size:"md",children:w&&(0,t.jsx)(_,{person:w,projects:h,onSubmit:W,onCancel:()=>P(null),isLoading:A})}),(0,t.jsx)(k.sm,{isOpen:null!==Z,onClose:()=>M(null),onConfirm:G,title:"Delete Person",message:'Are you sure you want to delete "'.concat(null==Z?void 0:Z.name,'"? This will remove them from all assigned tasks. This action cannot be undone.'),confirmText:"Delete",cancelText:"Cancel",variant:"danger",isLoading:A})]})}function S(e){let{person:a,projectName:r,projectColor:l,onEdit:n,onDelete:i}=e,[d,o]=(0,s.useState)(!1);return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("span",{className:"text-primary-600 dark:text-primary-400 font-semibold text-lg",children:a.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:a.name}),a.designation&&(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:a.designation})]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:()=>o(!d),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Person actions",children:(0,t.jsx)(g,{className:"w-4 h-4"})}),d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),(0,t.jsxs)("div",{className:"absolute right-0 top-full mt-1 w-36 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-20",children:[(0,t.jsxs)("button",{onClick:()=>{o(!1),n()},className:"w-full px-3 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[(0,t.jsx)(h,{className:"w-4 h-4"}),"Edit"]}),(0,t.jsxs)("button",{onClick:()=>{o(!1),i()},className:"w-full px-3 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4"}),"Delete"]})]})]})]})]}),(0,t.jsxs)("div",{className:"mt-4 space-y-2",children:[a.email&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)(p,{className:"w-4 h-4 flex-shrink-0"}),(0,t.jsx)("a",{href:"mailto:".concat(a.email),className:"hover:text-primary-600 dark:hover:text-primary-400 truncate",children:a.email})]}),a.company&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)(u,{className:"w-4 h-4 flex-shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:a.company})]}),(0,t.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:a.project_id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:l}}),(0,t.jsx)("span",{className:"truncate",children:r})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b,{className:"w-4 h-4 flex-shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:"Global (All Projects)"})]})})]})]})}function Z(){return(0,t.jsx)(l.A,{children:(0,t.jsx)(P,{})})}}},function(e){e.O(0,[2,212,217,909,748,971,117,744],function(){return e(e.s=47740)}),_N_E=e.O()}]);